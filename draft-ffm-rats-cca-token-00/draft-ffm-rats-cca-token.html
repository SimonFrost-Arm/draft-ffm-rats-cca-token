<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Arm's Confidential Compute Architecture Reference Attestation Token</title>
<meta content="Simon Frost" name="author">
<meta content="Thomas Fossati" name="author">
<meta content="Giri Mandyam" name="author">
<meta content="
       The Arm Confidential Compute Architecture (CCA) is series of hardware and software
innovations that enhance Armâ€™s support for Confidential Computing for large,
compute-intensive workloads. Devices that implement CCA can produce attestation
tokens as described in this memo, which are the basis for trustworthiness assessment of
the Confidential Compute environment.  This document specifies the CCA attestation
token structure and semantics. 
       The CCA attestation token is a profile of the Entity Attestation Token (EAT).
This specification describes what claims are used in an attestation token
generated by CCA compliant systems, how these claims get serialized to the
wire, and how they are cryptographically protected. 
       This informational document is published as an independent submission to improve
interoperability with Arm's architecture. It is not a standard nor
a product of the IETF. 
    " name="description">
<meta content="xml2rfc 3.22.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ffm-rats-cca-token-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 69.5.1
    wcwidth 0.2.13
-->
<link href="draft-ffm-rats-cca-token.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "â‡’";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">CCA Reference Attestation Token</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Frost, et al.</td>
<td class="center">Expires 5 January 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ffm-rats-cca-token-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-07-04" class="published">4 July 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-01-05">5 January 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Frost</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">T. Fossati</div>
<div class="org">Linaro</div>
</div>
<div class="author">
      <div class="author-name">G. Mandyam</div>
<div class="org">Mediatek Inc</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Arm's Confidential Compute Architecture Reference Attestation Token</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The Arm Confidential Compute Architecture (CCA) is series of hardware and software
innovations that enhance Armâ€™s support for Confidential Computing for large,
compute-intensive workloads. Devices that implement CCA can produce attestation
tokens as described in this memo, which are the basis for trustworthiness assessment of
the Confidential Compute environment.  This document specifies the CCA attestation
token structure and semantics.<a href="#section-abstract-1" class="pilcrow">Â¶</a></p>
<p id="section-abstract-2">The CCA attestation token is a profile of the Entity Attestation Token (EAT).
This specification describes what claims are used in an attestation token
generated by CCA compliant systems, how these claims get serialized to the
wire, and how they are cryptographically protected.<a href="#section-abstract-2" class="pilcrow">Â¶</a></p>
<p id="section-abstract-3">This informational document is published as an independent submission to improve
interoperability with Arm's architecture. It is not a standard nor
a product of the IETF.<a href="#section-abstract-3" class="pilcrow">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 5 January 2025.<a href="#section-boilerplate.1-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">â–²</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.Â Â <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.Â Â <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.Â Â <a href="#name-cca-attester-model" class="internal xref">CCA Attester Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.Â Â <a href="#name-cca-claims" class="internal xref">CCA Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.Â Â <a href="#name-cca-attestation-token-top-l" class="internal xref">CCA Attestation Token top level wrapper</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.Â Â <a href="#name-cca-platform-token-claims" class="internal xref">CCA Platform token Claims</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.Â Â <a href="#name-caller-claims" class="internal xref">Caller Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.Â Â <a href="#name-cca-platform-nonce" class="internal xref">CCA Platform Nonce</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.Â Â <a href="#name-target-identification-claim" class="internal xref">Target Identification Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.Â Â <a href="#name-cca-platform-instance-id" class="internal xref">CCA Platform Instance ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.Â Â <a href="#name-cca-platform-implementation" class="internal xref">CCA Platform Implementation ID</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.Â Â <a href="#name-target-state-claims" class="internal xref">Target State Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="auto internal xref">4.5.1</a>.Â Â <a href="#name-cca-platform-profile-defini" class="internal xref">CCA Platform Profile Definition</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.2">
                    <p id="section-toc.1-1.4.2.5.2.2.1"><a href="#section-4.5.2" class="auto internal xref">4.5.2</a>.Â Â <a href="#name-security-lifecycle" class="internal xref">Security Lifecycle</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.3">
                    <p id="section-toc.1-1.4.2.5.2.3.1"><a href="#section-4.5.3" class="auto internal xref">4.5.3</a>.Â Â <a href="#name-platform-config" class="internal xref">Platform Config</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.Â Â <a href="#name-software-inventory-claims" class="internal xref">Software Inventory Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.1">
                    <p id="section-toc.1-1.4.2.6.2.1.1"><a href="#section-4.6.1" class="auto internal xref">4.6.1</a>.Â Â <a href="#name-software-components" class="internal xref">Software Components</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.Â Â <a href="#name-verification-claims" class="internal xref">Verification Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7.2.1">
                    <p id="section-toc.1-1.4.2.7.2.1.1"><a href="#section-4.7.1" class="auto internal xref">4.7.1</a>.Â Â <a href="#name-verification-service-indica" class="internal xref">Verification Service Indicator</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7.2.2">
                    <p id="section-toc.1-1.4.2.7.2.2.1"><a href="#section-4.7.2" class="auto internal xref">4.7.2</a>.Â Â <a href="#name-cca-platform-hash-algorithm" class="internal xref">CCA Platform Hash Algorithm ID</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.Â Â <a href="#name-cca-realm-state-token-claim" class="internal xref">CCA Realm state token Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.1">
                    <p id="section-toc.1-1.4.2.8.2.1.1"><a href="#section-4.8.1" class="auto internal xref">4.8.1</a>.Â Â <a href="#name-realm-nonce" class="internal xref">Realm Nonce</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.2">
                    <p id="section-toc.1-1.4.2.8.2.2.1"><a href="#section-4.8.2" class="auto internal xref">4.8.2</a>.Â Â <a href="#name-cca-platform-profile-definit" class="internal xref">CCA Platform Profile Definition</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.3">
                    <p id="section-toc.1-1.4.2.8.2.3.1"><a href="#section-4.8.3" class="auto internal xref">4.8.3</a>.Â Â <a href="#name-realm-personalisation-value" class="internal xref">Realm Personalisation Value</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.4">
                    <p id="section-toc.1-1.4.2.8.2.4.1"><a href="#section-4.8.4" class="auto internal xref">4.8.4</a>.Â Â <a href="#name-realm-initial-measurement" class="internal xref">Realm Initial Measurement</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.5">
                    <p id="section-toc.1-1.4.2.8.2.5.1"><a href="#section-4.8.5" class="auto internal xref">4.8.5</a>.Â Â <a href="#name-realm-extensible-measuremen" class="internal xref">Realm Extensible Measurements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.6">
                    <p id="section-toc.1-1.4.2.8.2.6.1"><a href="#section-4.8.6" class="auto internal xref">4.8.6</a>.Â Â <a href="#name-realm-hash-algorithm-measur" class="internal xref">Realm Hash Algorithm Measurements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.7">
                    <p id="section-toc.1-1.4.2.8.2.7.1"><a href="#section-4.8.7" class="auto internal xref">4.8.7</a>.Â Â <a href="#name-realm-public-key" class="internal xref">Realm Public Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.8">
                    <p id="section-toc.1-1.4.2.8.2.8.1"><a href="#section-4.8.8" class="auto internal xref">4.8.8</a>.Â Â <a href="#name-realm-public-key-hash-algor" class="internal xref">Realm Public Key Hash Algorithm ID</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="auto internal xref">4.9</a>.Â Â <a href="#name-backwards-compatibility-con" class="internal xref">Backwards Compatibility Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10">
                <p id="section-toc.1-1.4.2.10.1"><a href="#section-4.10" class="auto internal xref">4.10</a>.Â <a href="#name-token-binding" class="internal xref">Token Binding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.11">
                <p id="section-toc.1-1.4.2.11.1"><a href="#section-4.11" class="auto internal xref">4.11</a>.Â <a href="#name-reference-profile" class="internal xref">Reference Profile</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.11.2.1">
                    <p id="section-toc.1-1.4.2.11.2.1.1"><a href="#section-4.11.1" class="auto internal xref">4.11.1</a>.Â Â <a href="#name-token-encoding-and-signing" class="internal xref">Token Encoding and Signing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.11.2.2">
                    <p id="section-toc.1-1.4.2.11.2.2.1"><a href="#section-4.11.2" class="auto internal xref">4.11.2</a>.Â Â <a href="#name-freshness-model" class="internal xref">Freshness Model</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.11.2.3">
                    <p id="section-toc.1-1.4.2.11.2.3.1"><a href="#section-4.11.3" class="auto internal xref">4.11.3</a>.Â Â <a href="#name-synopsis" class="internal xref">Synopsis</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.Â Â <a href="#name-collated-cddl" class="internal xref">Collated CDDL</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.Â Â <a href="#name-signing-key-implementation-" class="internal xref">Signing key implementation alternatives</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.Â Â <a href="#name-cca-attestation-token-verif" class="internal xref">CCA Attestation Token Verification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.Â Â <a href="#name-ar4si-trustworthiness-claim" class="internal xref">AR4SI Trustworthiness Claims Mappings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.Â Â <a href="#name-endorsements-reference-valu" class="internal xref">Endorsements, Reference Values and Verification Key Material</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.Â Â <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.Â Â <a href="#name-security-and-privacy-consid" class="internal xref">Security and Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>.Â <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.Â Â <a href="#name-cbor-web-token-claims-regis" class="internal xref">CBOR Web Token Claims Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a href="#section-10.1.1" class="auto internal xref">10.1.1</a>.Â Â <a href="#name-security-lifecycle-claim" class="internal xref">Security Lifecycle Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.2">
                    <p id="section-toc.1-1.10.2.1.2.2.1"><a href="#section-10.1.2" class="auto internal xref">10.1.2</a>.Â Â <a href="#name-implementation-id-claim" class="internal xref">Implementation ID Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.3">
                    <p id="section-toc.1-1.10.2.1.2.3.1"><a href="#section-10.1.3" class="auto internal xref">10.1.3</a>.Â Â <a href="#name-software-components-claim" class="internal xref">Software Components Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.4">
                    <p id="section-toc.1-1.10.2.1.2.4.1"><a href="#section-10.1.4" class="auto internal xref">10.1.4</a>.Â Â <a href="#name-verification-service-indicat" class="internal xref">Verification Service Indicator Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.5">
                    <p id="section-toc.1-1.10.2.1.2.5.1"><a href="#section-10.1.5" class="auto internal xref">10.1.5</a>.Â Â <a href="#name-platform-config-claim" class="internal xref">Platform Config Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.6">
                    <p id="section-toc.1-1.10.2.1.2.6.1"><a href="#section-10.1.6" class="auto internal xref">10.1.6</a>.Â Â <a href="#name-platform-hash-algorithm-id-" class="internal xref">Platform Hash Algorithm ID Clain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.7">
                    <p id="section-toc.1-1.10.2.1.2.7.1"><a href="#section-10.1.7" class="auto internal xref">10.1.7</a>.Â Â <a href="#name-cca-token-platform-token-la" class="internal xref">CCA Token Platform Token Label</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.8">
                    <p id="section-toc.1-1.10.2.1.2.8.1"><a href="#section-10.1.8" class="auto internal xref">10.1.8</a>.Â Â <a href="#name-realm-personalization-value" class="internal xref">Realm Personalization Value Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.9">
                    <p id="section-toc.1-1.10.2.1.2.9.1"><a href="#section-10.1.9" class="auto internal xref">10.1.9</a>.Â Â <a href="#name-realm-hash-algorithm-id-cla" class="internal xref">Realm Hash Algorithm ID Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.10">
                    <p id="section-toc.1-1.10.2.1.2.10.1"><a href="#section-10.1.10" class="auto internal xref">10.1.10</a>.Â <a href="#name-realm-public-key-claim" class="internal xref">Realm Public Key Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.11">
                    <p id="section-toc.1-1.10.2.1.2.11.1"><a href="#section-10.1.11" class="auto internal xref">10.1.11</a>.Â <a href="#name-realm-initial-measurement-c" class="internal xref">Realm Initial Measurement Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.12">
                    <p id="section-toc.1-1.10.2.1.2.12.1"><a href="#section-10.1.12" class="auto internal xref">10.1.12</a>.Â <a href="#name-realm-extensible-measurement" class="internal xref">Realm Extensible Measurements Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.13">
                    <p id="section-toc.1-1.10.2.1.2.13.1"><a href="#section-10.1.13" class="auto internal xref">10.1.13</a>.Â <a href="#name-realm-public-key-hash-algori" class="internal xref">Realm Public Key Hash Algorithm ID Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.14">
                    <p id="section-toc.1-1.10.2.1.2.14.1"><a href="#section-10.1.14" class="auto internal xref">10.1.14</a>.Â <a href="#name-cca-token-delegated-realm-t" class="internal xref">CCA Token Delegated Realm Token Label</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.Â Â <a href="#name-media-types" class="internal xref">Media Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.Â Â <a href="#name-coap-content-formats-regist" class="internal xref">CoAP Content-Formats Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.1">
                    <p id="section-toc.1-1.10.2.3.2.1.1"><a href="#section-10.3.1" class="auto internal xref">10.3.1</a>.Â Â <a href="#name-registry-contents" class="internal xref">Registry Contents</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>.Â <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.Â Â <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.Â Â <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.Â Â <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.Â Â <a href="#name-cose-sign1-token" class="internal xref">COSE Sign1 Token</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Arm Confidential Compute Architecture (CCA) <span>[<a href="#CCA-ARCH" class="cite xref">CCA-ARCH</a>]</span> is a set of hardware <span>[<a href="#RME" class="cite xref">RME</a>]</span>
and firmware <span>[<a href="#RMM" class="cite xref">RMM</a>]</span> specifications, backed by a reference implementation <span>[<a href="#TF-RMM" class="cite xref">TF-RMM</a>]</span> .<a href="#section-1-1" class="pilcrow">Â¶</a></p>
<p id="section-1-2">CCA provides confidential compute environments, called Realms, that can be dynamically
allocated by the Normal world host. The initial state of a Realm, and of the platform
on which it executes, can be attested. Attestation allows the Realm owner to establish
trust in the Realm, before provisioning any secrets to it. The Realm does not have to
inherit the trust from the Non-secure hypervisor which controls it.<a href="#section-1-2" class="pilcrow">Â¶</a></p>
<p id="section-1-3">As outlined in the RATS Architecture <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, an Attester produces a signed collection
of Claims that constitutes Evidence about its target environment. This document focuses
on the output provided by requests from the Realm to the Realm Management Monitor (RMM) management component for an
attestation token that covers the state of that Realm and the CCA Platform.
This output corresponds to Evidence in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> and, as a design decision, the CCA attestation
token is a profile of the Entity Attestation Token (EAT) <span>[<a href="#EAT" class="cite xref">EAT</a>]</span>. Note that there are other profiles
of EAT available, such as <span>[<a href="#I-D.kdyxy-rats-tdx-eat-profile" class="cite xref">I-D.kdyxy-rats-tdx-eat-profile</a>]</span> and <span>[<a href="#I-D.mandyam-rats-qwestoken" class="cite xref">I-D.mandyam-rats-qwestoken</a>]</span>,
for use with different use cases and by different attestation technologies.<a href="#section-1-3" class="pilcrow">Â¶</a></p>
<p id="section-1-4">Since the CCA tokens are consumed by services outside the device, there is an actual
need to ensure interoperability. Interoperability needs are addressed here by
describing the exact syntax and semantics of the attestation claims, and
defining the way these claims are encoded and cryptographically protected.<a href="#section-1-4" class="pilcrow">Â¶</a></p>
<p id="section-1-5">Further details on concepts expressed below can be found in the Realm Management Monitor
specification 1.0 <span>[<a href="#RMM" class="cite xref">RMM</a>]</span>.<a href="#section-1-5" class="pilcrow">Â¶</a></p>
<p id="section-1-6">As mentioned in the abstract, this memo documents a vendor extension
to the RATS architecture, and is not a standard.<a href="#section-1-6" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCPÂ 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">Â¶</a></p>
<p id="section-2-2">The terms Attester, Relying Party, Verifier, Attestation Result, Target Environment, Attesting Environment and Evidence
are defined in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>. We use the term "receiver" to refer to Relying Parties
and Verifiers.<a href="#section-2-2" class="pilcrow">Â¶</a></p>
<p id="section-2-3">We use the terms Evidence, "CCA attestation token", and "CCA token" interchangeably.
The terms "sender" and Attester are used interchangeably. Likewise, we use the terms
Verifier and "verification service" interchangeably.<a href="#section-2-3" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2-4">
        <dt id="section-2-4.1">RoT:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.2">
          <p id="section-2-4.2.1">Root of Trust, the minimal set of software, hardware and data that has to be
implicitly trusted in the platform - there is no software or hardware at a
deeper level that can verify that the Root of Trust is authentic and
unmodified.  An example of a RoT suitable
 for CCA would be an isolated
Trusted subsystem responsible for initial measurements, lifecycle state
management, identity and attestation services.  The services that the RoT
provides for securitization of the CCA environment are descibed as Hardware-Enforced Security (HES) -
see Section B4.1.5 of <span>[<a href="#RME" class="cite xref">RME</a>]</span>.<a href="#section-2-4.2.1" class="pilcrow">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.3">Realm-World:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.4">
          <p id="section-2-4.4.1">Realm World, provides a security state and physical address range that provides
an execution environment for VMs that is isolated from the Normal and Secure worlds.
The controlling firmware running in the Realm world can access memory in the Normal
world to allow shared buffers. (This is similar to Trusted Execution Environment (TEE),
"secure world", or "secure enclave".)<a href="#section-2-4.4.1" class="pilcrow">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.5">Realm:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.6">
          <p id="section-2-4.6.1">the Realm execution environment, is an Arm CCA environment that can be dynamically
allocated by the Normal world Host.<a href="#section-2-4.6.1" class="pilcrow">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.7">NW-Host:</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.8">
          <p id="section-2-4.8.1">Normal world host, refers to the security domain outside of the restricted Root,
Secure and Realm worlds. This typically contains the host hypervisor and supervisory
services. The NW-Host can allocate and manage resource allocation and can manage the
scheduling for other worlds.<a href="#section-2-4.8.1" class="pilcrow">Â¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-5">In this document, the structure of data is specified in Concise Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>.<a href="#section-2-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="cca-attester-model">
<section id="section-3">
      <h2 id="name-cca-attester-model">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-cca-attester-model" class="section-name selfRef">CCA Attester Model</a>
      </h2>
<p id="section-3-1"><a href="#fig-cca-attester" class="auto internal xref">Figure 1</a> outlines the structure of the CCA Attester according to
the conceptual model described in <span><a href="https://rfc-editor.org/rfc/rfc9334#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.<a href="#section-3-1" class="pilcrow">Â¶</a></p>
<span id="name-cca-attester"></span><div id="fig-cca-attester">
<figure id="figure-1">
        <div id="section-3-2.1">
          <div class="alignLeft art-svg artwork" id="section-3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="512" width="456" viewBox="0 0 456 512" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,144 L 8,448" fill="none" stroke="black"></path>
              <path d="M 24,160 L 24,288" fill="none" stroke="black"></path>
              <path d="M 24,320 L 24,432" fill="none" stroke="black"></path>
              <path d="M 64,208 L 64,272" fill="none" stroke="black"></path>
              <path d="M 64,352 L 64,400" fill="none" stroke="black"></path>
              <path d="M 112,272 L 112,352" fill="none" stroke="black"></path>
              <path d="M 168,208 L 168,272" fill="none" stroke="black"></path>
              <path d="M 176,352 L 176,400" fill="none" stroke="black"></path>
              <path d="M 208,208 L 208,272" fill="none" stroke="black"></path>
              <path d="M 232,176 L 232,208" fill="none" stroke="black"></path>
              <path d="M 256,208 L 256,272" fill="none" stroke="black"></path>
              <path d="M 304,208 L 304,272" fill="none" stroke="black"></path>
              <path d="M 312,352 L 312,400" fill="none" stroke="black"></path>
              <path d="M 320,32 L 320,64" fill="none" stroke="black"></path>
              <path d="M 344,176 L 344,208" fill="none" stroke="black"></path>
              <path d="M 360,72 L 360,208" fill="none" stroke="black"></path>
              <path d="M 360,272 L 360,352" fill="none" stroke="black"></path>
              <path d="M 408,32 L 408,64" fill="none" stroke="black"></path>
              <path d="M 416,208 L 416,272" fill="none" stroke="black"></path>
              <path d="M 416,352 L 416,400" fill="none" stroke="black"></path>
              <path d="M 432,160 L 432,288" fill="none" stroke="black"></path>
              <path d="M 432,320 L 432,432" fill="none" stroke="black"></path>
              <path d="M 448,144 L 448,448" fill="none" stroke="black"></path>
              <path d="M 320,32 L 408,32" fill="none" stroke="black"></path>
              <path d="M 320,64 L 408,64" fill="none" stroke="black"></path>
              <path d="M 8,144 L 352,144" fill="none" stroke="black"></path>
              <path d="M 368,144 L 448,144" fill="none" stroke="black"></path>
              <path d="M 24,160 L 352,160" fill="none" stroke="black"></path>
              <path d="M 368,160 L 432,160" fill="none" stroke="black"></path>
              <path d="M 240,176 L 288,176" fill="none" stroke="black"></path>
              <path d="M 304,176 L 344,176" fill="none" stroke="black"></path>
              <path d="M 64,208 L 168,208" fill="none" stroke="black"></path>
              <path d="M 208,208 L 256,208" fill="none" stroke="black"></path>
              <path d="M 304,208 L 416,208" fill="none" stroke="black"></path>
              <path d="M 168,240 L 200,240" fill="none" stroke="black"></path>
              <path d="M 264,240 L 304,240" fill="none" stroke="black"></path>
              <path d="M 64,272 L 168,272" fill="none" stroke="black"></path>
              <path d="M 208,272 L 256,272" fill="none" stroke="black"></path>
              <path d="M 304,272 L 416,272" fill="none" stroke="black"></path>
              <path d="M 24,288 L 104,288" fill="none" stroke="black"></path>
              <path d="M 120,288 L 352,288" fill="none" stroke="black"></path>
              <path d="M 368,288 L 432,288" fill="none" stroke="black"></path>
              <path d="M 24,320 L 104,320" fill="none" stroke="black"></path>
              <path d="M 120,320 L 352,320" fill="none" stroke="black"></path>
              <path d="M 368,320 L 432,320" fill="none" stroke="black"></path>
              <path d="M 64,352 L 104,352" fill="none" stroke="black"></path>
              <path d="M 120,352 L 176,352" fill="none" stroke="black"></path>
              <path d="M 312,352 L 352,352" fill="none" stroke="black"></path>
              <path d="M 368,352 L 416,352" fill="none" stroke="black"></path>
              <path d="M 64,400 L 176,400" fill="none" stroke="black"></path>
              <path d="M 312,400 L 416,400" fill="none" stroke="black"></path>
              <path d="M 24,432 L 432,432" fill="none" stroke="black"></path>
              <path d="M 8,448 L 448,448" fill="none" stroke="black"></path>
              <path d="M 112,480 L 136,480" fill="none" stroke="black"></path>
              <path d="M 216,480 L 240,480" fill="none" stroke="black"></path>
              <path d="M 328,480 L 344,480" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="368,72 356,66.4 356,77.6" fill="black" transform="rotate(270,360,72)"></polygon>
              <polygon class="arrowhead" points="272,240 260,234.4 260,245.6" fill="black" transform="rotate(180,264,240)"></polygon>
              <polygon class="arrowhead" points="248,480 236,474.4 236,485.6" fill="black" transform="rotate(0,240,480)"></polygon>
              <polygon class="arrowhead" points="248,176 236,170.4 236,181.6" fill="black" transform="rotate(180,240,176)"></polygon>
              <polygon class="arrowhead" points="208,240 196,234.4 196,245.6" fill="black" transform="rotate(0,200,240)"></polygon>
              <polygon class="arrowhead" points="144,480 132,474.4 132,485.6" fill="black" transform="rotate(0,136,480)"></polygon>
              <circle cx="112" cy="352" r="6" class="opendot" fill="white" stroke="black"></circle>
              <circle cx="352" cy="480" r="6" class="opendot" fill="white" stroke="black"></circle>
              <circle cx="360" cy="352" r="6" class="opendot" fill="white" stroke="black"></circle>
              <g class="text">
                <text x="364" y="52">Verifier</text>
                <text x="288" y="116">CCA</text>
                <text x="328" y="116">Token</text>
                <text x="72" y="180">Attesting</text>
                <text x="160" y="180">Environment</text>
                <text x="296" y="180">R</text>
                <text x="92" y="228">Main</text>
                <text x="232" y="228">HES</text>
                <text x="336" y="228">Realm</text>
                <text x="116" y="244">Bootloader</text>
                <text x="232" y="244">RoT</text>
                <text x="356" y="244">Management</text>
                <text x="184" y="260">W</text>
                <text x="280" y="260">R</text>
                <text x="344" y="260">Monitor</text>
                <text x="96" y="372">Realm</text>
                <text x="144" y="372">World</text>
                <text x="344" y="372">Realm</text>
                <text x="112" y="388">TCB</text>
                <text x="344" y="388">State</text>
                <text x="60" y="420">Target</text>
                <text x="136" y="420">Environment</text>
                <text x="32" y="468">Legend:</text>
                <text x="164" y="484">read</text>
                <text x="272" y="484">write</text>
                <text x="392" y="484">measure</text>
                <text x="120" y="500">R</text>
                <text x="224" y="500">W</text>
              </g>
            </svg><a href="#section-3-2.1.1" class="pilcrow">Â¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-cca-attester" class="selfRef">CCA Attester</a>
        </figcaption></figure>
</div>
<p id="section-3-3">The CCA Attester is a relatively straightforward embodiment of the RATS
Attester with exactly one Attesting Environment and one or more Target Environments.<a href="#section-3-3" class="pilcrow">Â¶</a></p>
<p id="section-3-4">The Attesting Environment is responsible for collecting the information to be
represented in CCA claims and to assemble them into Evidence. It is made of three
cooperating components:<a href="#section-3-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">
          <p id="section-3-5.1.1">The Main Bootloader, executing at boot-time, measures the trusted computing base (TCB) of the Realm World<a href="#section-3-5.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-3-5.2">
          <p id="section-3-5.2.1">i.e., loaded firmware components and sends them to the HES RoT to be stored isolated.
(CCA Platform Boot State). See <a href="#fig-cca-attester-boot" class="auto internal xref">Figure 2</a>.<a href="#section-3-5.2.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<span id="name-cca-attester-boot-phase"></span><div id="fig-cca-attester-boot">
<figure id="figure-2">
        <div id="section-3-6.1">
          <div class="alignCenter art-svg artwork" id="section-3-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="224" width="352" viewBox="0 0 352 224" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,80 L 8,192" fill="none" stroke="black"></path>
              <path d="M 80,64 L 80,208" fill="none" stroke="black"></path>
              <path d="M 192,64 L 192,208" fill="none" stroke="black"></path>
              <path d="M 304,64 L 304,208" fill="none" stroke="black"></path>
              <path d="M 344,80 L 344,192" fill="none" stroke="black"></path>
              <path d="M 8,80 L 72,80" fill="none" stroke="black"></path>
              <path d="M 88,80 L 184,80" fill="none" stroke="black"></path>
              <path d="M 200,80 L 296,80" fill="none" stroke="black"></path>
              <path d="M 312,80 L 344,80" fill="none" stroke="black"></path>
              <path d="M 96,128 L 192,128" fill="none" stroke="black"></path>
              <path d="M 192,176 L 296,176" fill="none" stroke="black"></path>
              <path d="M 8,192 L 72,192" fill="none" stroke="black"></path>
              <path d="M 88,192 L 184,192" fill="none" stroke="black"></path>
              <path d="M 200,192 L 296,192" fill="none" stroke="black"></path>
              <path d="M 312,192 L 344,192" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="304,176 292,170.4 292,181.6" fill="black" transform="rotate(0,296,176)"></polygon>
              <circle cx="88" cy="128" r="6" class="opendot" fill="white" stroke="black"></circle>
              <g class="text">
                <text x="52" y="36">i-th</text>
                <text x="100" y="36">Target</text>
                <text x="172" y="36">Main</text>
                <text x="212" y="36">Boot</text>
                <text x="304" y="36">HES</text>
                <text x="80" y="52">Environment</text>
                <text x="196" y="52">Loader</text>
                <text x="304" y="52">RoT</text>
                <text x="36" y="100">loop</text>
                <text x="64" y="100">i</text>
                <text x="120" y="116">measure</text>
                <text x="224" y="148">write</text>
                <text x="248" y="164">measurement</text>
              </g>
            </svg><a href="#section-3-6.1.1" class="pilcrow">Â¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-cca-attester-boot-phase" class="selfRef">CCA Attester Boot Phase</a>
        </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-3-7.1">
          <p id="section-3-7.1.1">The Realm Management Monitor (RMM), executing at run-time, maintains measurements for
the state of a Realm. It can respond to requests issued from a Realm for an attestation
token relevant for that Realm by obtaining a CCA Platform attestation token from the
HES RoT and combining that with an attestation token containing Evidence reflecting
Realm state.<a href="#section-3-7.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-3-7.2">
          <p id="section-3-7.2.1">The HES RoT, executing at run-time, maintains measurements for the state of the CCA
platform TCB, including the lifecycle state of the CCA platform. It can answer requests
coming from the RMM to collect and format claims corresponding to that state and use a
CCA Platform Attestation Key (CPAK) to sign them.  How the CPAK is derived is implementation-specific.<a href="#section-3-7.2.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<div id="para-pak-intro">
<p id="section-3-8">See <a href="#fig-cca-attester-runtime" class="auto internal xref">Figure 3</a>.<a href="#section-3-8" class="pilcrow">Â¶</a></p>
</div>
<span id="name-cca-attester-run-time-phase"></span><div id="fig-cca-attester-runtime">
<figure id="figure-3">
        <div id="section-3-9.1">
          <div class="alignCenter art-svg artwork" id="section-3-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="576" width="360" viewBox="0 0 360 576" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 24,160 L 24,192" fill="none" stroke="black"></path>
              <path d="M 96,64 L 96,560" fill="none" stroke="black"></path>
              <path d="M 160,368 L 160,400" fill="none" stroke="black"></path>
              <path d="M 192,448 L 192,480" fill="none" stroke="black"></path>
              <path d="M 224,64 L 224,560" fill="none" stroke="black"></path>
              <path d="M 320,64 L 320,560" fill="none" stroke="black"></path>
              <path d="M 8,80 L 352,80" fill="none" stroke="black"></path>
              <path d="M 104,176 L 224,176" fill="none" stroke="black"></path>
              <path d="M 64,256 L 88,256" fill="none" stroke="black"></path>
              <path d="M 64,288 L 88,288" fill="none" stroke="black"></path>
              <path d="M 96,304 L 216,304" fill="none" stroke="black"></path>
              <path d="M 192,448 L 224,448" fill="none" stroke="black"></path>
              <path d="M 192,480 L 216,480" fill="none" stroke="black"></path>
              <path d="M 224,544 L 312,544" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="320,544 308,538.4 308,549.6" fill="black" transform="rotate(0,312,544)"></polygon>
              <polygon class="arrowhead" points="224,480 212,474.4 212,485.6" fill="black" transform="rotate(0,216,480)"></polygon>
              <polygon class="arrowhead" points="224,304 212,298.4 212,309.6" fill="black" transform="rotate(0,216,304)"></polygon>
              <polygon class="arrowhead" points="168,400 156,394.4 156,405.6" fill="black" transform="rotate(90,160,400)"></polygon>
              <polygon class="arrowhead" points="112,176 100,170.4 100,181.6" fill="black" transform="rotate(180,104,176)"></polygon>
              <polygon class="arrowhead" points="96,288 84,282.4 84,293.6" fill="black" transform="rotate(0,88,288)"></polygon>
              <polygon class="arrowhead" points="72,256 60,250.4 60,261.6" fill="black" transform="rotate(180,64,256)"></polygon>
              <polygon class="arrowhead" points="32,192 20,186.4 20,197.6" fill="black" transform="rotate(90,24,192)"></polygon>
              <g class="text">
                <text x="96" y="36">HES</text>
                <text x="216" y="36">Realm</text>
                <text x="96" y="52">RoT</text>
                <text x="224" y="52">Manager</text>
                <text x="324" y="52">Verifier</text>
                <text x="44" y="116">Platform</text>
                <text x="28" y="132">Boot</text>
                <text x="32" y="148">State</text>
                <text x="124" y="148">Req.</text>
                <text x="180" y="148">Platform</text>
                <text x="128" y="164">Token</text>
                <text x="180" y="164">(#RAK)</text>
                <text x="36" y="212">Platform</text>
                <text x="84" y="212">&lt;-</text>
                <text x="40" y="228">Token</text>
                <text x="84" y="228">-&gt;</text>
                <text x="44" y="276">sign</text>
                <text x="140" y="292">Plat</text>
                <text x="184" y="292">Token</text>
                <text x="160" y="340">Realm</text>
                <text x="160" y="356">State</text>
                <text x="160" y="420">Realm</text>
                <text x="160" y="436">Token</text>
                <text x="164" y="468">sign</text>
                <text x="248" y="532">CCA</text>
                <text x="288" y="532">Token</text>
              </g>
            </svg><a href="#section-3-9.1.1" class="pilcrow">Â¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-cca-attester-run-time-phase" class="selfRef">CCA Attester Run-time Phase</a>
        </figcaption></figure>
</div>
<p id="section-3-10">The Target Environment consists of two elements:<a href="#section-3-10" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-11.1">
          <p id="section-3-11.1.1">Realm World TCB - hardware, firmware and configuration contributions.<a href="#section-3-11.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-3-11.2">
          <p id="section-3-11.2.1">Individual state of a Realm - measurements of the initial state of the Realm
and dynamic measurements provided by Realm guest code.<a href="#section-3-11.2.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-3-12">A reference implementation of the CCA Attester is provided by <span>[<a href="#TF-RMM" class="cite xref">TF-RMM</a>]</span>.<a href="#section-3-12" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-cca-claims">
<section id="section-4">
      <h2 id="name-cca-claims">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-cca-claims" class="section-name selfRef">CCA Claims</a>
      </h2>
<p id="section-4-1">This section describes the claims to be used in a CCA reference attestation token.<a href="#section-4-1" class="pilcrow">Â¶</a></p>
<p id="section-4-2">There are two logical sections within the CCA attestation token, relating to the two
Target Environment elements:<a href="#section-4-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">
          <p id="section-4-3.1.1">The CCA Platform token<a href="#section-4-3.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-4-3.2">
          <p id="section-4-3.2.1">The Realm state token<a href="#section-4-3.2.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-4-4">The two sections use inter-related claims to bind together into a single logical unit.
See <a href="#sec-security-consideration" class="auto internal xref">Section 9</a> for more details.<a href="#section-4-4" class="pilcrow">Â¶</a></p>
<p id="section-4-5">The above tokens are presented to the requester within a top level Conceptual Message WWrapper (CMW) collection <span>[<a href="#CMW" class="cite xref">CMW</a>]</span>.<a href="#section-4-5" class="pilcrow">Â¶</a></p>
<p id="section-4-6">CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> along with text descriptions is used to define each claim
independent of encoding.  The following CDDL type(s) are reused by different
claims:<a href="#section-4-6" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-7">
<pre>
arm-platform-hash-type = bytes .size 32 / bytes .size 48 / bytes .size 64

</pre><a href="#section-4-7" class="pilcrow">Â¶</a>
</div>
<p id="section-4-8">Two conventions are used to encode the Right-Hand-Side (RHS) of a claim: the postfix <code>-label</code> is used for EAT-defined claims, and the postfix <code>-key</code> for PSA-originated claims.<a href="#section-4-8" class="pilcrow">Â¶</a></p>
<div id="sec-cca-token-collection">
<section id="section-4.1">
        <h3 id="name-cca-attestation-token-top-l">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-cca-attestation-token-top-l" class="section-name selfRef">CCA Attestation Token top level wrapper</a>
        </h3>
<p id="section-4.1-1">The above tokens are presented to the requester within a top level CMW collection <span>[<a href="#CMW" class="cite xref">CMW</a>]</span>.
The collection map has two entries, one for a bstr encoding of the CCA Platform token and
the other for a bstr encoding of the Realm state token/<a href="#section-4.1-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
cca-token = #6.399(cca-token-collection) ; CMW (draft-ietf-rats-msg-wrap) Collection

cca-platform-token = bstr .cbor COSE_Sign1_Tagged
cca-realm-delegated-token = bstr .cbor COSE_Sign1_Tagged

cca-token-collection = {
    44234 =&gt; cca-platform-token          ; 44234 = 0xACCA
    44241 =&gt; cca-realm-delegated-token
}

; EAT standard definitions
COSE_Sign1_Tagged = #6.18(COSE_Sign1)

; Deliberately shortcut these definitions until EAT is finalised and able to
; pull in the full set of definitions
COSE_Sign1 = "COSE-Sign1 placeholder"
</pre><a href="#section-4.1-2" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="cca-platform-token-claims">
<section id="section-4.2">
        <h3 id="name-cca-platform-token-claims">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-cca-platform-token-claims" class="section-name selfRef">CCA Platform token Claims</a>
      </h3>
</section>
</div>
<div id="caller-claims">
<section id="section-4.3">
        <h3 id="name-caller-claims">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-caller-claims" class="section-name selfRef">Caller Claims</a>
        </h3>
<div id="sec-platform-nonce-claim">
<section id="section-4.3.1">
          <h4 id="name-cca-platform-nonce">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-cca-platform-nonce" class="section-name selfRef">CCA Platform Nonce</a>
          </h4>
<p id="section-4.3.1-1">The Nonce claim is used to carry a challenge provided by the caller to demonstrate freshness of the generated token.<a href="#section-4.3.1-1" class="pilcrow">Â¶</a></p>
<p id="section-4.3.1-2">The EAT <span>[<a href="#EAT" class="cite xref">EAT</a>]</span> <code>nonce</code> (claim key 10) is used.  Since the EAT nonce claim offers flexiblity for different
attestation technologies, this specifications applies the following constraints
 to the <code>nonce-type</code>:<a href="#section-4.3.1-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-3.1">
              <p id="section-4.3.1-3.1.1">The length MUST be either 32, 48, or 64 bytes.<a href="#section-4.3.1-3.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-3.2">
              <p id="section-4.3.1-3.2.1">Only a single nonce value is conveyed. The array notation MUST NOT be used for encoding the nonce value.<a href="#section-4.3.1-3.2.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
<p id="section-4.3.1-4">Where the CCA Platform implementation uses the Delegated Token signing model <a href="#sec-token-binding" class="auto internal xref">Section 4.10</a>, the
value of the Nonce claim will be a hash of the Realm Public Key claim of the CCA Realm State token
<a href="#sec-realm-public-key-claim" class="auto internal xref">Section 4.8.7</a>.<a href="#section-4.3.1-4" class="pilcrow">Â¶</a></p>
<p id="section-4.3.1-5">This claim MUST be present in a CCA Platform attestation token.<a href="#section-4.3.1-5" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.1-6">
<pre>
arm-platform-challenge-label = 10

arm-platform-challenge = (
    arm-platform-challenge-label =&gt; arm-platform-hash-type
)

</pre><a href="#section-4.3.1-6" class="pilcrow">Â¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="target-identification-claims">
<section id="section-4.4">
        <h3 id="name-target-identification-claim">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-target-identification-claim" class="section-name selfRef">Target Identification Claims</a>
        </h3>
<div id="sec-instance-id-claim">
<section id="section-4.4.1">
          <h4 id="name-cca-platform-instance-id">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-cca-platform-instance-id" class="section-name selfRef">CCA Platform Instance ID</a>
          </h4>
<p id="section-4.4.1-1">The Instance ID claim represents the unique identifier of the Platform
Attestation Key (PAK).
The EAT <code>ueid</code> (claim key 256) of type RAND is used.  The following constraints
apply to the <code>ueid-type</code>:<a href="#section-4.4.1-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-2.1">
              <p id="section-4.4.1-2.1.1">The length MUST be 33 bytes.<a href="#section-4.4.1-2.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-4.4.1-2.2">
              <p id="section-4.4.1-2.2.1">The first byte MUST be 0x01 (RAND) followed by the 32-byte unique identifier of the PAK.<a href="#section-4.4.1-2.2.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
<p id="section-4.4.1-3">This claim MUST be present in a CCA Platform attestation token.<a href="#section-4.4.1-3" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.1-4">
<pre>
arm-platform-instance-id-label = 256 ; EAT ueid

; TODO: require that the first byte of arm-platform-instance-id-type is 0x01
; EAT UEIDs need to be 7 - 33 bytes
arm-platform-instance-id-type = bytes .size 33

arm-platform-instance-id = (
    arm-platform-instance-id-label =&gt; arm-platform-instance-id-type
)

</pre><a href="#section-4.4.1-4" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="sec-implementation-id">
<section id="section-4.4.2">
          <h4 id="name-cca-platform-implementation">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-cca-platform-implementation" class="section-name selfRef">CCA Platform Implementation ID</a>
          </h4>
<p id="section-4.4.2-1">The Implementation ID claim uniquely identifies the implementation of the
CCA Platform. A verification service uses this claim to locate the
details of the CCA Platform implementation from an Endorser or manufacturer.
Such details are used by a verification service to determine the security properties
or certification status of the CCA Platform implementation.<a href="#section-4.4.2-1" class="pilcrow">Â¶</a></p>
<p id="section-4.4.2-2">The value and format of the ID is decided by
the manufacturer or a particular certification scheme. For example, the ID
could take the form of a product serial number,
database ID, or other appropriate identifier.<a href="#section-4.4.2-2" class="pilcrow">Â¶</a></p>
<p id="section-4.4.2-3">This claim MUST be present in a CCA Platform attestation token.<a href="#section-4.4.2-3" class="pilcrow">Â¶</a></p>
<p id="section-4.4.2-4">Note that this identifies the CCA Platform implementation, not a particular instance.
To uniquely identify an instance, see the Instance ID claim <a href="#sec-instance-id-claim" class="auto internal xref">Section 4.4.1</a>.<a href="#section-4.4.2-4" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.2-5">
<pre>
arm-platform-implementation-id-label = 2396 ; PSA implementation ID
arm-platform-implementation-id-type = bytes .size 32

arm-platform-implementation-id = (
    arm-platform-implementation-id-label =&gt; arm-platform-implementation-id-type
)

</pre><a href="#section-4.4.2-5" class="pilcrow">Â¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="target-state-claims">
<section id="section-4.5">
        <h3 id="name-target-state-claims">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-target-state-claims" class="section-name selfRef">Target State Claims</a>
        </h3>
<div id="sec-plat-profile-definition-claim">
<section id="section-4.5.1">
          <h4 id="name-cca-platform-profile-defini">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-cca-platform-profile-defini" class="section-name selfRef">CCA Platform Profile Definition</a>
          </h4>
<p id="section-4.5.1-1">The CCA platform profile claim identifies the EAT profile to which the CCA platform token
conforms. This allows a receiver to assign the intended semantics to the rest of the claims
found in the token.<a href="#section-4.5.1-1" class="pilcrow">Â¶</a></p>
<p id="section-4.5.1-2">The EAT <code>eat_profile</code> (claim key 265) is used.<a href="#section-4.5.1-2" class="pilcrow">Â¶</a></p>
<p id="section-4.5.1-3">The format of the CCA platform profile claim is defined as a text string of value
"tag:arm.com,2023:cca#1.0.0".<a href="#section-4.5.1-3" class="pilcrow">Â¶</a></p>
<p id="section-4.5.1-4">This claim MUST be present in a CCA Platform attestation token.<a href="#section-4.5.1-4" class="pilcrow">Â¶</a></p>
<p id="section-4.5.1-5">See <a href="#sec-backwards-compat" class="auto internal xref">Section 4.9</a>, for considerations about backwards compatibility
with previous versions of the CCA Platform attestation token format.<a href="#section-4.5.1-5" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.1-6">
<pre>
cca-platform-profile-label = 265 ; EAT profile

cca-platform-profile-type = "tag:arm.com,2023:cca_platform#1.0.0"

cca-platform-profile = (
    cca-platform-profile-label =&gt; cca-platform-profile-type
)
</pre><a href="#section-4.5.1-6" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="sec-security-lifecycle">
<section id="section-4.5.2">
          <h4 id="name-security-lifecycle">
<a href="#section-4.5.2" class="section-number selfRef">4.5.2. </a><a href="#name-security-lifecycle" class="section-name selfRef">Security Lifecycle</a>
          </h4>
<p id="section-4.5.2-1">The Security Lifecycle claim represents the current lifecycle state of the CCA
Platform.<a href="#section-4.5.2-1" class="pilcrow">Â¶</a></p>
<p id="section-4.5.2-2">The state is represented by an integer that is divided as follows:<a href="#section-4.5.2-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5.2-3.1">
              <p id="section-4.5.2-3.1.1">major[15:8] - CCA Platform security lifecycle state, and<a href="#section-4.5.2-3.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-4.5.2-3.2">
              <p id="section-4.5.2-3.2.1">minor[7:0] - IMPLEMENTATION DEFINED state.<a href="#section-4.5.2-3.2.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
<p id="section-4.5.2-4">The CCA Platform lifecycle states are illustrated in <a href="#fig-lifecycle-states" class="auto internal xref">Figure 4</a>.
A non debugged CCA platform will be in psa-lifecycle-secured state.
Realm Management Security Domain debug is always recoverable, and would
therefore be represented by psa-lifecycle-non-psa-rot-debug state. Root
world debug is recoverable on a HES system and would be represented by
psa-lifecycle-recoverable-psa-rot state. On a non-HES system Root world
debug is usually non-recoverable, and would be represented by
psa-lifecycle-lifecycle-decommissioned state<a href="#section-4.5.2-4" class="pilcrow">Â¶</a></p>
<p id="section-4.5.2-5">This claim MUST be present in a CCA Platform attestation token.<a href="#section-4.5.2-5" class="pilcrow">Â¶</a></p>
<span id="name-cca-platform-lifecycle-stat"></span><div id="fig-lifecycle-states">
<figure id="figure-4">
            <div id="section-4.5.2-6.1">
              <div class="alignLeft art-svg artwork" id="section-4.5.2-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="608" width="512" viewBox="0 0 512 608" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 48,256 L 48,272" fill="none" stroke="black"></path>
                  <path d="M 48,336 L 48,464" fill="none" stroke="black"></path>
                  <path d="M 120,128 L 120,160" fill="none" stroke="black"></path>
                  <path d="M 128,32 L 128,64" fill="none" stroke="black"></path>
                  <path d="M 152,448 L 152,480" fill="none" stroke="black"></path>
                  <path d="M 152,544 L 152,576" fill="none" stroke="black"></path>
                  <path d="M 168,240 L 168,272" fill="none" stroke="black"></path>
                  <path d="M 168,368 L 168,416" fill="none" stroke="black"></path>
                  <path d="M 184,272 L 184,288" fill="none" stroke="black"></path>
                  <path d="M 184,336 L 184,360" fill="none" stroke="black"></path>
                  <path d="M 216,160 L 216,232" fill="none" stroke="black"></path>
                  <path d="M 216,488 L 216,536" fill="none" stroke="black"></path>
                  <path d="M 232,64 L 232,120" fill="none" stroke="black"></path>
                  <path d="M 240,192 L 240,232" fill="none" stroke="black"></path>
                  <path d="M 272,280 L 272,368" fill="none" stroke="black"></path>
                  <path d="M 280,448 L 280,480" fill="none" stroke="black"></path>
                  <path d="M 288,544 L 288,576" fill="none" stroke="black"></path>
                  <path d="M 296,368 L 296,416" fill="none" stroke="black"></path>
                  <path d="M 304,240 L 304,272" fill="none" stroke="black"></path>
                  <path d="M 344,32 L 344,64" fill="none" stroke="black"></path>
                  <path d="M 352,128 L 352,160" fill="none" stroke="black"></path>
                  <path d="M 352,368 L 352,416" fill="none" stroke="black"></path>
                  <path d="M 376,256 L 376,272" fill="none" stroke="black"></path>
                  <path d="M 376,320 L 376,360" fill="none" stroke="black"></path>
                  <path d="M 376,416 L 376,464" fill="none" stroke="black"></path>
                  <path d="M 416,192 L 416,368" fill="none" stroke="black"></path>
                  <path d="M 432,368 L 432,416" fill="none" stroke="black"></path>
                  <path d="M 128,32 L 344,32" fill="none" stroke="black"></path>
                  <path d="M 128,64 L 344,64" fill="none" stroke="black"></path>
                  <path d="M 120,128 L 352,128" fill="none" stroke="black"></path>
                  <path d="M 120,160 L 352,160" fill="none" stroke="black"></path>
                  <path d="M 240,192 L 416,192" fill="none" stroke="black"></path>
                  <path d="M 168,240 L 304,240" fill="none" stroke="black"></path>
                  <path d="M 48,256 L 168,256" fill="none" stroke="black"></path>
                  <path d="M 304,256 L 376,256" fill="none" stroke="black"></path>
                  <path d="M 168,272 L 304,272" fill="none" stroke="black"></path>
                  <path d="M 168,368 L 248,368" fill="none" stroke="black"></path>
                  <path d="M 264,368 L 296,368" fill="none" stroke="black"></path>
                  <path d="M 352,368 L 432,368" fill="none" stroke="black"></path>
                  <path d="M 168,416 L 296,416" fill="none" stroke="black"></path>
                  <path d="M 352,416 L 432,416" fill="none" stroke="black"></path>
                  <path d="M 152,448 L 280,448" fill="none" stroke="black"></path>
                  <path d="M 48,464 L 144,464" fill="none" stroke="black"></path>
                  <path d="M 288,464 L 376,464" fill="none" stroke="black"></path>
                  <path d="M 152,480 L 280,480" fill="none" stroke="black"></path>
                  <path d="M 152,544 L 288,544" fill="none" stroke="black"></path>
                  <path d="M 152,576 L 288,576" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="384,360 372,354.4 372,365.6" fill="black" transform="rotate(90,376,360)"></polygon>
                  <polygon class="arrowhead" points="296,464 284,458.4 284,469.6" fill="black" transform="rotate(180,288,464)"></polygon>
                  <polygon class="arrowhead" points="280,280 268,274.4 268,285.6" fill="black" transform="rotate(270,272,280)"></polygon>
                  <polygon class="arrowhead" points="248,232 236,226.4 236,237.6" fill="black" transform="rotate(90,240,232)"></polygon>
                  <polygon class="arrowhead" points="240,120 228,114.4 228,125.6" fill="black" transform="rotate(90,232,120)"></polygon>
                  <polygon class="arrowhead" points="224,536 212,530.4 212,541.6" fill="black" transform="rotate(90,216,536)"></polygon>
                  <polygon class="arrowhead" points="224,232 212,226.4 212,237.6" fill="black" transform="rotate(90,216,232)"></polygon>
                  <polygon class="arrowhead" points="192,360 180,354.4 180,365.6" fill="black" transform="rotate(90,184,360)"></polygon>
                  <polygon class="arrowhead" points="152,464 140,458.4 140,469.6" fill="black" transform="rotate(0,144,464)"></polygon>
                  <g class="text">
                    <text x="164" y="52">Device</text>
                    <text x="228" y="52">Assembly</text>
                    <text x="280" y="52">and</text>
                    <text x="316" y="52">Test</text>
                    <text x="268" y="84">Device</text>
                    <text x="276" y="100">Lockdown</text>
                    <text x="144" y="148">CCA</text>
                    <text x="196" y="148">Security</text>
                    <text x="284" y="148">Provisioning</text>
                    <text x="156" y="196">Provisioning</text>
                    <text x="156" y="212">Lockdown</text>
                    <text x="464" y="244">Recoverable</text>
                    <text x="232" y="260">Secured</text>
                    <text x="48" y="292">Non</text>
                    <text x="360" y="292">Recoverable</text>
                    <text x="48" y="308">Recoverable</text>
                    <text x="156" y="308">RM</text>
                    <text x="192" y="308">Debug</text>
                    <text x="332" y="308">Root</text>
                    <text x="376" y="308">Debug</text>
                    <text x="20" y="324">Root</text>
                    <text x="64" y="324">Debug</text>
                    <text x="188" y="324">Enable</text>
                    <text x="200" y="388">Realm</text>
                    <text x="256" y="388">Manager</text>
                    <text x="388" y="388">Root</text>
                    <text x="224" y="404">Debug</text>
                    <text x="384" y="404">Debug</text>
                    <text x="216" y="468">Terminate</text>
                    <text x="220" y="564">Decommissioned</text>
                  </g>
                </svg><a href="#section-4.5.2-6.1.1" class="pilcrow">Â¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-cca-platform-lifecycle-stat" class="selfRef">CCA Platform Lifecycle States</a>
            </figcaption></figure>
</div>
<p id="section-4.5.2-7">The CDDL representation is shown below.
<a href="#tab-states-map" class="auto internal xref">Table 1</a> provides the mappings between <a href="#fig-lifecycle-states" class="auto internal xref">Figure 4</a> and the data model.<a href="#section-4.5.2-7" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.2-8">
<pre>
arm-platform-lifecycle-label = 2395 ; PSA lifecycle

arm-platform-lifecycle-unknown-type = 0x0000..0x00ff
arm-platform-lifecycle-assembly-and-test-type = 0x1000..0x10ff
arm-platform-lifecycle-arm-platform-rot-provisioning-type = 0x2000..0x20ff
arm-platform-lifecycle-secured-type = 0x3000..0x30ff
arm-platform-lifecycle-non-arm-platform-rot-debug-type = 0x4000..0x40ff
arm-platform-lifecycle-recoverable-arm-platform-rot-debug-type = 0x5000..0x50ff
arm-platform-lifecycle-decommissioned-type = 0x6000..0x60ff

arm-platform-lifecycle-type =
    arm-platform-lifecycle-unknown-type /
    arm-platform-lifecycle-assembly-and-test-type /
    arm-platform-lifecycle-arm-platform-rot-provisioning-type /
    arm-platform-lifecycle-secured-type /
    arm-platform-lifecycle-non-arm-platform-rot-debug-type /
    arm-platform-lifecycle-recoverable-arm-platform-rot-debug-type /
    arm-platform-lifecycle-decommissioned-type

arm-platform-lifecycle = (
    arm-platform-lifecycle-label =&gt; arm-platform-lifecycle-type
)

</pre><a href="#section-4.5.2-8" class="pilcrow">Â¶</a>
</div>
<p id="section-4.5.2-9"><code>psa-lifecycle-unknown-type</code> is not shown in <a href="#fig-lifecycle-states" class="auto internal xref">Figure 4</a>; it represents an invalid state that must not occur in a system.<a href="#section-4.5.2-9" class="pilcrow">Â¶</a></p>
<span id="name-lifecycle-states-mappings"></span><div id="tab-states-map">
<table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-lifecycle-states-mappings" class="selfRef">Lifecycle States Mappings</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">CDDL</th>
                <th class="text-left" rowspan="1" colspan="1">Lifecycle States</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-unknown-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Â </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-assembly-and-test-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Assembly and Test</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-psa-rot-provisioning-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">CCA Platform Provisioning</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-secured-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Secured</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-non-psa-rot-debug-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Non-Recoverable CCA Platform Debug</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-recoverable-psa-rot-debug-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Recoverable CCA Platform Debug</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-decommissioned-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Decommissioned</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="sec-platform-config">
<section id="section-4.5.3">
          <h4 id="name-platform-config">
<a href="#section-4.5.3" class="section-number selfRef">4.5.3. </a><a href="#name-platform-config" class="section-name selfRef">Platform Config</a>
          </h4>
<p id="section-4.5.3-1">The CCA platform config claim describes the set of chosen implementation options
of the CCA platform. As an example, these may include a description of the level
of physical memory protection which is provided.<a href="#section-4.5.3-1" class="pilcrow">Â¶</a></p>
<p id="section-4.5.3-2">The CCA platform config claim is expected to contain the System Properties field
which is present in the Root Non-volatile Storage (RNVS) public parameters.<a href="#section-4.5.3-2" class="pilcrow">Â¶</a></p>
<p id="section-4.5.3-3">This claim MUST be present in a CCA Platform attestation token.<a href="#section-4.5.3-3" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.3-4">
<pre>
arm-platform-config-label = 2401 ; PSA platform range
                                 ; TBD: add to IANA registration
arm-platform-config-type = bytes

arm-platform-config = (
    arm-platform-config-label =&gt; arm-platform-config-type
)

</pre><a href="#section-4.5.3-4" class="pilcrow">Â¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="software-inventory-claims">
<section id="section-4.6">
        <h3 id="name-software-inventory-claims">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-software-inventory-claims" class="section-name selfRef">Software Inventory Claims</a>
        </h3>
<div id="sec-sw-components">
<section id="section-4.6.1">
          <h4 id="name-software-components">
<a href="#section-4.6.1" class="section-number selfRef">4.6.1. </a><a href="#name-software-components" class="section-name selfRef">Software Components</a>
          </h4>
<p id="section-4.6.1-1">The Software Components claim is a list of software components which can affect
the behavior of the CCA platform.<a href="#section-4.6.1-1" class="pilcrow">Â¶</a></p>
<p id="section-4.6.1-2">This claim MUST be present in a CCA Platform attestation token.<a href="#section-4.6.1-2" class="pilcrow">Â¶</a></p>
<p id="section-4.6.1-3">Each entry in the Software Components list describes one software component
using the attributes described in the following subsections.  Unless explicitly
stated, the presence of an attribute is OPTIONAL.<a href="#section-4.6.1-3" class="pilcrow">Â¶</a></p>
<p id="section-4.6.1-4">Note that, as described in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, a relying party will typically see the
result of the appraisal process from the Verifier in form of an Attestation
Result, rather than the CCA Platform token from the attesting endpoint.
Therefore, a relying party is not expected to understand the Software
Components claim.  Instead, it is for the Verifier to check this claim against
the available Reference Values and provide an answer in form of an "high level"
Attestation Result, which may or may not include the original Software
Components claim.<a href="#section-4.6.1-4" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6.1-5">
<pre>
arm-platform-sw-components-label = 2399 ; PSA software components

arm-platform-sw-component = {
  ? 1 =&gt; text,                   ; component type
    2 =&gt; arm-platform-hash-type, ; measurement value
  ? 4 =&gt; text,                   ; version
    5 =&gt; arm-platform-hash-type, ; signer id
  ? 6 =&gt; text,                   ; hash algorithm identifier
}

arm-platform-sw-components = (
    arm-platform-sw-components-label =&gt; [ + arm-platform-sw-component ]
)

</pre><a href="#section-4.6.1-5" class="pilcrow">Â¶</a>
</div>
<div id="component-type">
<section id="section-4.6.1.1">
            <h5 id="name-component-type">
<a href="#section-4.6.1.1" class="section-number selfRef">4.6.1.1. </a><a href="#name-component-type" class="section-name selfRef">Component Type</a>
            </h5>
<p id="section-4.6.1.1-1">The Component Type attribute (key=1) is a short string representing the role of
this software component. This attribute is intended for use as a hint to help
the verifier understand how to evaluate the CCA platform software component
measurement value.<a href="#section-4.6.1.1-1" class="pilcrow">Â¶</a></p>
<p id="section-4.6.1.1-2">This attribute is optional in a CCA Platform software component.<a href="#section-4.6.1.1-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="measurement-value">
<section id="section-4.6.1.2">
            <h5 id="name-measurement-value">
<a href="#section-4.6.1.2" class="section-number selfRef">4.6.1.2. </a><a href="#name-measurement-value" class="section-name selfRef">Measurement Value</a>
            </h5>
<p id="section-4.6.1.2-1">The Measurement Value attribute (key=2) represents a hash of the invariant
software component in memory at the time it was initialized.
The value MUST be a cryptographic hash of 256 bits or stronger.<a href="#section-4.6.1.2-1" class="pilcrow">Â¶</a></p>
<p id="section-4.6.1.2-2">This attribute MUST be present in a PSA software component.<a href="#section-4.6.1.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="version">
<section id="section-4.6.1.3">
            <h5 id="name-version">
<a href="#section-4.6.1.3" class="section-number selfRef">4.6.1.3. </a><a href="#name-version" class="section-name selfRef">Version</a>
            </h5>
<p id="section-4.6.1.3-1">The Version attribute (key=4) is the issued software version in the form of a
text string. The meaning of this string is defined by the software component
vendor.<a href="#section-4.6.1.3-1" class="pilcrow">Â¶</a></p>
<p id="section-4.6.1.3-2">This attribute is optional in a CCA Platform software component.<a href="#section-4.6.1.3-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="signer-id">
<section id="section-4.6.1.4">
            <h5 id="name-signer-id">
<a href="#section-4.6.1.4" class="section-number selfRef">4.6.1.4. </a><a href="#name-signer-id" class="section-name selfRef">Signer ID</a>
            </h5>
<p id="section-4.6.1.4-1">The Signer ID attribute (key=5) uniquely identifies the signer of the software component.
The identification is typically accomplished by hashing the signer's public key.
The value of this attribute will correspond to the
entry in the original manifest for the component. This can be used by a
Verifier to ensure the components were signed by an expected trusted source.<a href="#section-4.6.1.4-1" class="pilcrow">Â¶</a></p>
<p id="section-4.6.1.4-2">This attribute MUST be present in a CCA Platform software component.<a href="#section-4.6.1.4-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="measurement-description">
<section id="section-4.6.1.5">
            <h5 id="name-measurement-description">
<a href="#section-4.6.1.5" class="section-number selfRef">4.6.1.5. </a><a href="#name-measurement-description" class="section-name selfRef">Measurement Description</a>
            </h5>
<p id="section-4.6.1.5-1">The Measurement Description attribute (key=6) contains a string identifying the
hash algorithm used to compute the corresponding Measurement Value.  The string
SHOULD be encoded according to "Hash Name String" in the "Named Information Hash Algorithm Registry" <span>[<a href="#IANA.named-information" class="cite xref">IANA.named-information</a>]</span>.<a href="#section-4.6.1.5-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="measurement-description-1">
<section id="section-4.6.1.6">
            <h5 id="name-measurement-description-2">
<a href="#section-4.6.1.6" class="section-number selfRef">4.6.1.6. </a><a href="#name-measurement-description-2" class="section-name selfRef">Measurement Description</a>
            </h5>
<p id="section-4.6.1.6-1">The Measurement Description attribute (key=6) contains a string identifying the
hash algorithm used to compute the corresponding Measurement Value.  The string
SHOULD be encoded according to "Hash Name String" in the "Named Information Hash Algorithm Registry" <span>[<a href="#IANA.named-information" class="cite xref">IANA.named-information</a>]</span>.<a href="#section-4.6.1.6-1" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="verification-claims">
<section id="section-4.7">
        <h3 id="name-verification-claims">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-verification-claims" class="section-name selfRef">Verification Claims</a>
        </h3>
<p id="section-4.7-1">The following claims are part of the CCA Platform token (and therefore still Evidence)
but aim to help receivers, including relying parties, with the
processing of the received attestation Evidence.<a href="#section-4.7-1" class="pilcrow">Â¶</a></p>
<div id="sec-verification-service-indicator">
<section id="section-4.7.1">
          <h4 id="name-verification-service-indica">
<a href="#section-4.7.1" class="section-number selfRef">4.7.1. </a><a href="#name-verification-service-indica" class="section-name selfRef">Verification Service Indicator</a>
          </h4>
<p id="section-4.7.1-1">The Verification Service Indicator claim is a hint used by a relying party to
locate a verification service for the token. The value is a text string that
can be used to locate the service (typically, a URL specifying the address of
the verification service API). A Relying Party may choose to ignore this claim
in favor of other information.<a href="#section-4.7.1-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.7.1-2">
<pre>
arm-platform-verification-service-label = 2400 ; PSA verification service
arm-platform-verification-service-type = text

arm-platform-verification-service = (
    arm-platform-verification-service-label =&gt;
        arm-platform-verification-service-type
)

</pre><a href="#section-4.7.1-2" class="pilcrow">Â¶</a>
</div>
<p id="section-4.7.1-3">It is assumed that the relying party is pre-configured with a list of trusted
verification services and that the contents of this hint can be used to look
up the correct one. Under no circumstances must the relying party be tricked
into contacting an unknown and untrusted verification service since the
returned Attestation Result cannot be relied on.<a href="#section-4.7.1-3" class="pilcrow">Â¶</a></p>
<p id="section-4.7.1-4">Note: This hint requires the relying party to parse the content of the
CCA Platform token. Since the relying party may not be in possession of a trust
anchor to verify the digital signature, it uses the hint in the same way
as it would treat any other information provided by an external party,
which includes attacker-provided data.<a href="#section-4.7.1-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-arm-platform-hash-algm-id">
<section id="section-4.7.2">
          <h4 id="name-cca-platform-hash-algorithm">
<a href="#section-4.7.2" class="section-number selfRef">4.7.2. </a><a href="#name-cca-platform-hash-algorithm" class="section-name selfRef">CCA Platform Hash Algorithm ID</a>
          </h4>
<p id="section-4.7.2-1">The CCA platform hash algorithm ID claim is a text string that identifies
the algorithm used to calculate the extended measurements in the CCA platform token.<a href="#section-4.7.2-1" class="pilcrow">Â¶</a></p>
<p id="section-4.7.2-2">The string SHOULD be encoded according to "Hash Name String" in the "Named
Information Hash Algorithm Registry" <span>[<a href="#IANA.named-information" class="cite xref">IANA.named-information</a>]</span>.<a href="#section-4.7.2-2" class="pilcrow">Â¶</a></p>
<p id="section-4.7.2-3">The CCA platform hash algorithm ID claim MUST be present in a CCA platform token.<a href="#section-4.7.2-3" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.7.2-4">
<pre>
arm-platform-hash-algo-id-label = 2402 ; PSA platform range
                                       ; TBD: add to IANA registration

arm-platform-hash-algo-id = (
    arm-platform-hash-algo-id-label =&gt; text
)

</pre><a href="#section-4.7.2-4" class="pilcrow">Â¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="cca-realm-state-token-claims">
<section id="section-4.8">
        <h3 id="name-cca-realm-state-token-claim">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-cca-realm-state-token-claim" class="section-name selfRef">CCA Realm state token Claims</a>
        </h3>
<p id="section-4.8-1">The CCA Realm state token contains claims that represent the Target Environment
that is the Realm that requested the attestation report.<a href="#section-4.8-1" class="pilcrow">Â¶</a></p>
<div id="sec-realm-nonce-claim">
<section id="section-4.8.1">
          <h4 id="name-realm-nonce">
<a href="#section-4.8.1" class="section-number selfRef">4.8.1. </a><a href="#name-realm-nonce" class="section-name selfRef">Realm Nonce</a>
          </h4>
<p id="section-4.8.1-1">The Nonce claim is used to carry a challenge provided by the caller to demonstrate freshness of the generated token.<a href="#section-4.8.1-1" class="pilcrow">Â¶</a></p>
<p id="section-4.8.1-2">The EAT <span>[<a href="#EAT" class="cite xref">EAT</a>]</span> <code>nonce</code> (claim key 10) is used.  Since the EAT nonce claim offers flexiblity for different
attestation technologies, this specification applies the following constraints
 to the <code>nonce-type</code>:<a href="#section-4.8.1-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8.1-3.1">
              <p id="section-4.8.1-3.1.1">The length MUST be either 32, 48, or 64 bytes.<a href="#section-4.8.1-3.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-4.8.1-3.2">
              <p id="section-4.8.1-3.2.1">Only a single nonce value is conveyed. The array notation MUST NOT be used for encoding the nonce value.<a href="#section-4.8.1-3.2.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
<p id="section-4.8.1-4">This claim MUST be present in a CCA Realm state attestation token.<a href="#section-4.8.1-4" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8.1-5">
<pre>
cca-realm-challenge-label = 10
cca-realm-challenge-type = bytes .size 64

cca-realm-challenge = (
    cca-realm-challenge-label =&gt; cca-realm-challenge-type
)
</pre><a href="#section-4.8.1-5" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="sec-realm-profile-definition-claim">
<section id="section-4.8.2">
          <h4 id="name-cca-platform-profile-definit">
<a href="#section-4.8.2" class="section-number selfRef">4.8.2. </a><a href="#name-cca-platform-profile-definit" class="section-name selfRef">CCA Platform Profile Definition</a>
          </h4>
<p id="section-4.8.2-1">The Realm profile claim identifies the EAT profile to which the Realm token
conforms. This allows a receiver to assign the intended semantics to the rest of the claims
found in the token.<a href="#section-4.8.2-1" class="pilcrow">Â¶</a></p>
<p id="section-4.8.2-2">The EAT <code>eat_profile</code> (claim key 265) is used.<a href="#section-4.8.2-2" class="pilcrow">Â¶</a></p>
<p id="section-4.8.2-3">The format of the CCA platform profile claim is defined as a text string of value
"tag:arm.com,2023:realm#1.0.0".<a href="#section-4.8.2-3" class="pilcrow">Â¶</a></p>
<p id="section-4.8.2-4">This claim is OPTIONAL in a CCA Realm attestation token.
If the Realm profile is not included in a CCA Realm token then the profile value
used in the CCA Platform token should refer to a profile that describes both
Platform and Realm claims.<a href="#section-4.8.2-4" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8.2-5">
<pre>
cca-realm-profile-label = 265 ; EAT profile

cca-realm-profile-type = "tag:arm.com,2023:realm#1.0.0"

cca-realm-profile = (
    cca-realm-profile-label =&gt; cca-realm-profile-type
)
</pre><a href="#section-4.8.2-5" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="sec-realm-personalisation-value-claim">
<section id="section-4.8.3">
          <h4 id="name-realm-personalisation-value">
<a href="#section-4.8.3" class="section-number selfRef">4.8.3. </a><a href="#name-realm-personalisation-value" class="section-name selfRef">Realm Personalisation Value</a>
          </h4>
<p id="section-4.8.3-1">The Realm Personalization Value (RPV) claim contains the RPV which was provided
at Realm creation.<a href="#section-4.8.3-1" class="pilcrow">Â¶</a></p>
<p id="section-4.8.3-2">This claim MUST be present in a CCA Realm state attestation token.<a href="#section-4.8.3-2" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8.3-3">
<pre>
cca-realm-personalization-value-label = 44235
cca-realm-personalization-value-type = bytes .size 64

cca-realm-personalization-value = (
    cca-realm-personalization-value-label =&gt; cca-realm-personalization-value-type
)
</pre><a href="#section-4.8.3-3" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="sec-realm-initial-measurement-claim">
<section id="section-4.8.4">
          <h4 id="name-realm-initial-measurement">
<a href="#section-4.8.4" class="section-number selfRef">4.8.4. </a><a href="#name-realm-initial-measurement" class="section-name selfRef">Realm Initial Measurement</a>
          </h4>
<p id="section-4.8.4-1">The Realm Initial Measurement claim contains the measurements taken of Realm state
before the Realm is activated.<a href="#section-4.8.4-1" class="pilcrow">Â¶</a></p>
<p id="section-4.8.4-2">This claim MUST be present in a CCA Realm state attestation token.<a href="#section-4.8.4-2" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8.4-3">
<pre>
cca-realm-initial-measurement-label = 44238

cca-realm-initial-measurement = (
    cca-realm-initial-measurement-label =&gt; cca-realm-measurement-type
)
</pre><a href="#section-4.8.4-3" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="sec-realm-extensible-measurements-claim">
<section id="section-4.8.5">
          <h4 id="name-realm-extensible-measuremen">
<a href="#section-4.8.5" class="section-number selfRef">4.8.5. </a><a href="#name-realm-extensible-measuremen" class="section-name selfRef">Realm Extensible Measurements</a>
          </h4>
<p id="section-4.8.5-1">The Realm Extensible Measurements claim contains measurements provided by Realm
guest software and extended to the set of Realm Extensible Measurements
maintained by the RMM.<a href="#section-4.8.5-1" class="pilcrow">Â¶</a></p>
<p id="section-4.8.5-2">This claim MUST be present in a CCA Realm state attestation token.<a href="#section-4.8.5-2" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8.5-3">
<pre>
cca-realm-extensible-measurements-label = 44239

cca-realm-extensible-measurements = (
    cca-realm-extensible-measurements-label =&gt; [ 4*4 cca-realm-measurement-type ]
)
</pre><a href="#section-4.8.5-3" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="sec-realm-hash-algm-id-claim">
<section id="section-4.8.6">
          <h4 id="name-realm-hash-algorithm-measur">
<a href="#section-4.8.6" class="section-number selfRef">4.8.6. </a><a href="#name-realm-hash-algorithm-measur" class="section-name selfRef">Realm Hash Algorithm Measurements</a>
          </h4>
<p id="section-4.8.6-1">The Realm hash algorithm ID claim identifies the algorithm used to calculate
all hash values which are present in the Realm token.<a href="#section-4.8.6-1" class="pilcrow">Â¶</a></p>
<p id="section-4.8.6-2">The string value of the claim SHOULD be encoded according to "Hash Name String"
in the "Named Information Hash Algorithm Registry" <span>[<a href="#IANA.named-information" class="cite xref">IANA.named-information</a>]</span>.<a href="#section-4.8.6-2" class="pilcrow">Â¶</a></p>
<p id="section-4.8.6-3">This claim MUST be present in a CCA Realm state attestation token.<a href="#section-4.8.6-3" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8.6-4">
<pre>
cca-realm-hash-algo-id-label = 44236

cca-realm-hash-algo-id = (
    cca-realm-hash-algo-id-label =&gt; text
)
</pre><a href="#section-4.8.6-4" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="sec-realm-public-key-claim">
<section id="section-4.8.7">
          <h4 id="name-realm-public-key">
<a href="#section-4.8.7" class="section-number selfRef">4.8.7. </a><a href="#name-realm-public-key" class="section-name selfRef">Realm Public Key</a>
          </h4>
<p id="section-4.8.7-1">The Realm public key claim identifies the attestation key which is used to sign the Realm token<a href="#section-4.8.7-1" class="pilcrow">Â¶</a></p>
<p id="section-4.8.7-2">The value of the Realm public key claim is a byte string representation of a COSE_Key.<a href="#section-4.8.7-2" class="pilcrow">Â¶</a></p>
<p id="section-4.8.7-3">This claim MUST be present in a CCA Realm state attestation token.<a href="#section-4.8.7-3" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8.7-4">
<pre>
cca-realm-public-key-label = 44237

; See RFC8152 for definition of COSE_Key
cca-realm-public-key-type = bstr .cbor COSE_Key

cca-realm-public-key = (
    cca-realm-public-key-label =&gt; cca-realm-public-key-type
)
</pre><a href="#section-4.8.7-4" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="sec-realm-public-key-hash-algo-id-claim">
<section id="section-4.8.8">
          <h4 id="name-realm-public-key-hash-algor">
<a href="#section-4.8.8" class="section-number selfRef">4.8.8. </a><a href="#name-realm-public-key-hash-algor" class="section-name selfRef">Realm Public Key Hash Algorithm ID</a>
          </h4>
<p id="section-4.8.8-1">The Realm public key hash algorithm identifier claim identifies the algorithm used to
hash the value of the Realm Public Key claim <a href="#sec-realm-public-key-claim" class="auto internal xref">Section 4.8.7</a>
such that it can be presented as a Challenge for the bound CCA Platform token
<a href="#sec-token-binding" class="auto internal xref">Section 4.10</a>.<a href="#section-4.8.8-1" class="pilcrow">Â¶</a></p>
<p id="section-4.8.8-2">This claim MUST be present in a CCA Realm state attestation token.<a href="#section-4.8.8-2" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8.8-3">
<pre>
cca-realm-public-key-hash-algo-id-label = 44240

cca-realm-public-key-hash-algo-id = (
    cca-realm-public-key-hash-algo-id-label =&gt; text
)
</pre><a href="#section-4.8.8-3" class="pilcrow">Â¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sec-backwards-compat">
<section id="section-4.9">
        <h3 id="name-backwards-compatibility-con">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-backwards-compatibility-con" class="section-name selfRef">Backwards Compatibility Considerations</a>
        </h3>
<p id="section-4.9-1">This profile conforms to the claims in the Beta2 release of the 1.0 release of the
Realm Management Monitor specification. <span>[<a href="#RMM" class="cite xref">RMM</a>]</span>. There has not been a prior
release of this specification to the 1.0 release. Hence this section is a
place holder for claim changes introduced in future releases.<a href="#section-4.9-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-token-binding">
<section id="section-4.10">
        <h3 id="name-token-binding">
<a href="#section-4.10" class="section-number selfRef">4.10. </a><a href="#name-token-binding" class="section-name selfRef">Token Binding</a>
        </h3>
<p id="section-4.10-1">The reference implementation uses a 'Delegated Model' for token signing.
In this model, the completion of signing operations for the CCA token is
delegated from the CCA Platform RoT to the RMM. When the RMM initialises,
it obtains a 'Realm Attestation Token' (RAK) signing key pair from the CCA
Platform RoT. The public part of that key pair is hashed and used as a
challenge to obtain a CCA Platform token (signed by the CCA Platform RoT).
When guest code in a Realm requests a CCA Attestation token, the RMM
prepares a Realm state token, signed by the RAK private key, then wraps
both tokens in a CMW Collection. The two tokens are bound together by
the Nonce claim in the CCA Platform token having the same value as a
hash of the Realm Public key claim in the Realm state token (using the
hash algorithm identified by the Realm Public Key Hash Algorithm ID claim).<a href="#section-4.10-1" class="pilcrow">Â¶</a></p>
<p id="section-4.10-2">A verifier MUST check this binding is valid when verifying a CCA
Attestation token.<a href="#section-4.10-2" class="pilcrow">Â¶</a></p>
<p id="section-4.10-3">An implementation may choose instead a 'Direct Model'. In this model,
when guest code in a Realm requests a CCA Attestation token, the RMM
prepares a Realm state claim set, but does not wrap it in a CMW.
Instead, the claim set is hashed and this value is used as a Challenge
to obtain a CCA Platform token, signed by the CCA Platform RoT. The
CCA Platform and Realm state claim set are presented within a CMW Collection
as in the Delegated model. The two parts of the collection are bound
together by the Nonce claim in the CCA Platform token having the same value
as the hash of the Realm state claim set. If the Direct Model is used,
the CCA Platform profile claim <a href="#sec-plat-profile-definition-claim" class="auto internal xref">Section 4.5.1</a> MUST
have a different value from the reference profile. The map value within
the CCA Attestation token CMW Collection for the Realm state claim set
MUST also have a different value to that used for a Realm state CMW
token. In such a profile, the Realm Public Key <a href="#sec-realm-public-key-claim" class="auto internal xref">Section 4.8.7</a>
and Realm Public Key Hash Algorithm ID <a href="#sec-realm-public-key-hash-algo-id-claim" class="auto internal xref">Section 4.8.8</a> claims
will not be used.<a href="#section-4.10-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-reference-profile">
<section id="section-4.11">
        <h3 id="name-reference-profile">
<a href="#section-4.11" class="section-number selfRef">4.11. </a><a href="#name-reference-profile" class="section-name selfRef">Reference Profile</a>
        </h3>
<div id="sec-token-encoding-and-signing">
<section id="section-4.11.1">
          <h4 id="name-token-encoding-and-signing">
<a href="#section-4.11.1" class="section-number selfRef">4.11.1. </a><a href="#name-token-encoding-and-signing" class="section-name selfRef">Token Encoding and Signing</a>
          </h4>
<p id="section-4.11.1-1">The CCA attestation token is encoded in CBOR <span>[<a href="#STD94" class="cite xref">STD94</a>]</span> format.
The CBOR representation of a CCA attestation token MUST be "valid" according to the definition in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-1.2" class="relref">Section 1.2</a> of [<a href="#STD94" class="cite xref">STD94</a>]</span>.
Besides, only definite-length string, arrays, and maps are allowed.<a href="#section-4.11.1-1" class="pilcrow">Â¶</a></p>
<p id="section-4.11.1-2">Given that a PSA Attester is typically found in a constrained device, it MAY
NOT emit CBOR preferred serializations (<span><a href="https://rfc-editor.org/rfc/rfc8949#section-4.1" class="relref">Section 4.1</a> of [<a href="#STD94" class="cite xref">STD94</a>]</span>).
Therefore, the Verifier MUST be a variation-tolerant CBOR decoder.
TODO.... need different narrative from IoT reasons...<a href="#section-4.11.1-2" class="pilcrow">Â¶</a></p>
<p id="section-4.11.1-3">Cryptographic protection is obtained by wrapping the CCA Platform and Realm state claims-set in a COSE
Web Token (CWT) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.  The signature structure MUST be a tagged (18) COSE_Sign1.<a href="#section-4.11.1-3" class="pilcrow">Â¶</a></p>
<p id="section-4.11.1-4">Acknowledging the variety of markets, regulations and use cases in which the
CCA attestation token can be used, the baseline profile does not impose any
strong requirement on the cryptographic algorithms that need to be supported by
Attesters and Verifiers.  The flexibility provided by the COSE format should be
sufficient to deal with the level of cryptographic agility needed to adapt to
specific use cases.  It is RECOMMENDED that commonly adopted algorithms are
used, such as those discussed in <span>[<a href="#COSE-ALGS" class="cite xref">COSE-ALGS</a>]</span>.  It is expected that receivers
will accept a wider range of algorithms, while Attesters would produce CCA tokens
using only one such algorithm.<a href="#section-4.11.1-4" class="pilcrow">Â¶</a></p>
<p id="section-4.11.1-5">The CCA Platform token is always directly signed by the CCA Platform RoT.  Therefore, the CCA
claims-set is never carried in a Detached EAT bundle
(<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-28#section-5" class="relref">Section 5</a> of [<a href="#EAT" class="cite xref">EAT</a>]</span>).<a href="#section-4.11.1-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="freshness-model">
<section id="section-4.11.2">
          <h4 id="name-freshness-model">
<a href="#section-4.11.2" class="section-number selfRef">4.11.2. </a><a href="#name-freshness-model" class="section-name selfRef">Freshness Model</a>
          </h4>
<p id="section-4.11.2-1">The CCA token supports the freshness models for attestation Evidence based on
nonces and epoch handles (Section <a href="https://rfc-editor.org/rfc/rfc9334#section-10.2" class="relref">10.2</a> and Section <a href="https://rfc-editor.org/rfc/rfc9334#section-10.3" class="relref">10.3</a> of <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) using
the <code>nonce</code> claim to convey the nonce or epoch handle supplied by the Verifier.
No further assumption on the specific remote attestation protocol is made.<a href="#section-4.11.2-1" class="pilcrow">Â¶</a></p>
<p id="section-4.11.2-2">Note that use of epoch handles is constrained by the type restrictions imposed by the <code>eat_nonce</code> syntax.
For use in CCA tokens, it must be possible to encode the epoch handle as an opaque binary string between 8 and 64 octets.<a href="#section-4.11.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="synopsis">
<section id="section-4.11.3">
          <h4 id="name-synopsis">
<a href="#section-4.11.3" class="section-number selfRef">4.11.3. </a><a href="#name-synopsis" class="section-name selfRef">Synopsis</a>
          </h4>
<p id="section-4.11.3-1"><a href="#tbl-baseline-profile" class="auto internal xref">Table 2</a> presents a concise view of the requirements described in the preceding sections.<a href="#section-4.11.3-1" class="pilcrow">Â¶</a></p>
<span id="name-baseline-profile"></span><div id="tbl-baseline-profile">
<table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-baseline-profile" class="selfRef">Baseline Profile</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Issue</th>
                <th class="text-left" rowspan="1" colspan="1">Profile Definition</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CBOR/JSON</td>
                <td class="text-left" rowspan="1" colspan="1">CBOR MUST be used</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CBOR Encoding</td>
                <td class="text-left" rowspan="1" colspan="1">Definite length maps and arrays MUST be used</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CBOR Encoding</td>
                <td class="text-left" rowspan="1" colspan="1">Definite length strings MUST be used</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CBOR Serialization</td>
                <td class="text-left" rowspan="1" colspan="1">Variant serialization MAY be used</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">COSE Protection</td>
                <td class="text-left" rowspan="1" colspan="1">COSE_Sign1 MUST be used</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Algorithms</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#COSE-ALGS" class="cite xref">COSE-ALGS</a>]</span> SHOULD be used</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Detached EAT Bundle Usage</td>
                <td class="text-left" rowspan="1" colspan="1">Detached EAT bundles MUST NOT be sent</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Verification Key Identification</td>
                <td class="text-left" rowspan="1" colspan="1">Any identification method listed in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-28#appendix-F.1" class="relref">Appendix F.1</a> of [<a href="#EAT" class="cite xref">EAT</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Endorsements</td>
                <td class="text-left" rowspan="1" colspan="1">See <a href="#sec-cca-endorsements" class="auto internal xref">Section 7.2</a>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Freshness</td>
                <td class="text-left" rowspan="1" colspan="1">nonce or epoch ID based</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Claims</td>
                <td class="text-left" rowspan="1" colspan="1">Those defined in <a href="#sec-cca-claims" class="auto internal xref">Section 4</a>. As per general EAT rules, the receiver MUST NOT error out on claims it does not understand.</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="collated-cddl">
<section id="section-5">
      <h2 id="name-collated-cddl">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-collated-cddl" class="section-name selfRef">Collated CDDL</a>
      </h2>
<div class="alignLeft art-text artwork" id="section-5-1">
<pre>
TODO...include cddl/cca-attestation.cddl
</pre><a href="#section-5-1" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="sec-signing-keys">
<section id="section-6">
      <h2 id="name-signing-key-implementation-">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-signing-key-implementation-" class="section-name selfRef">Signing key implementation alternatives</a>
      </h2>
<p id="section-6-1">In the CCA Platform reference design, PAKs (<a href="#para-pak-intro" class="auto internal xref">Section 3, Paragraph 8</a>) are raw public keys.<a href="#section-6-1" class="pilcrow">Â¶</a></p>
<p id="section-6-2">Some implementations may choose to use an PAK that is a certified public key. If
this option is taken, the value of the CCA Platform Profile Definition claim
<a href="#sec-plat-profile-definition-claim" class="auto internal xref">Section 4.5.1</a> MUST be altered from the reference implementation
value.<a href="#section-6-2" class="pilcrow">Â¶</a></p>
<p id="section-6-3">TODO... perhaps lose this justification section as...<a href="#section-6-3" class="pilcrow">Â¶</a></p>
<p id="section-6-4">Certified public keys require the manufacturer to run the certification
authority (CA) that issues X.509 certs for the PAKs.  (Note that operating a CA
is a complex and expensive task that may be unaffordable to certain
manufacturers.)<a href="#section-6-4" class="pilcrow">Â¶</a></p>
<p id="section-6-5">Using certified public keys offers better scalability properties when compared to using raw public keys, namely:<a href="#section-6-5" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-6.1">
          <p id="section-6-6.1.1">storage requirements for the Verifier are minimised - the same
manufacturer's trust anchor is used for any number of devices,<a href="#section-6-6.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-6-6.2">
          <p id="section-6-6.2.1">the provisioning model is simpler and more robust since there is no need to
notify the Verifier about each newly manufactured device,<a href="#section-6-6.2.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-6-7">Furthermore, existing and well-understood revocation mechanisms can be readily used.<a href="#section-6-7" class="pilcrow">Â¶</a></p>
<p id="section-6-8">TODO... ...to here<a href="#section-6-8" class="pilcrow">Â¶</a></p>
<p id="section-6-9">The PAK's X.509 cert can be inlined in the CCA Platform token using the <code>x5chain</code> COSE
header parameter <span>[<a href="#COSE-X509" class="cite xref">COSE-X509</a>]</span> at the cost of an increase in the CCA Platform token
size.
Note that the exact split between pre-provisioned and inlined certs may vary
depending on the specific deployment.  In that respect, <code>x5chain</code> is quite
flexible: it can contain the end-entity (EE) cert only, the EE and a partial
chain, or the EE and the full chain up to the trust anchor (see <span><a href="https://rfc-editor.org/rfc/rfc9360#section-2" class="relref">Section 2</a> of [<a href="#COSE-X509" class="cite xref">COSE-X509</a>]</span> for the details).<a href="#section-6-9" class="pilcrow">Â¶</a></p>
<p id="section-6-10">TODO...lose following as IoT centric?? ::
Constraints around network bandwidth and computing resources available to endpoints,
such as network buffers, may dictate a reasonable split point.<a href="#section-6-10" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="cca-attestation-token-verification">
<section id="section-7">
      <h2 id="name-cca-attestation-token-verif">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-cca-attestation-token-verif" class="section-name selfRef">CCA Attestation Token Verification</a>
      </h2>
<p id="section-7-1">To verify the token for the reference profile, the initial need is to check correct
encoding for the token. Primary trust is established by checking the signing of
the CCA Platform token CWT.
The key used for verification is supplied to the Verifier by an
authorized Endorser along with the corresponding Attester's Instance ID.
For the verifier, the CCA Platform Instance ID <a href="#sec-instance-id-claim" class="auto internal xref">Section 4.4.1</a> claim is
used to assist locating the key used to verify the signature covering the CCA Platform
CWT token. The verifier can also be supplied with the information that the
key instance has been revoked and is no longer valid.<a href="#section-7-1" class="pilcrow">Â¶</a></p>
<p id="section-7-2">Additional validation checks on the token are:<a href="#section-7-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-3.1">
          <p id="section-7-3.1.1">Checking that the binding between the CCA Platform token and the Realm state
token is valid <a href="#sec-token-binding" class="auto internal xref">Section 4.10</a>}. This has the side effect of establishing
the trustworthiness of the RAK public key.<a href="#section-7-3.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-7-3.2">
          <p id="section-7-3.2.1">Validating that the Realm state token is correctly signed by the RAK.<a href="#section-7-3.2.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-7-3.3">
          <p id="section-7-3.3.1">Checking that the value of the lll claim is psa-lifecycle-secured state. Note
that some other values of this claim (psa-lifecycle-non-psa-rot-debug and
psa-lifecycle-recoverable-psa-rot states) may indicate that the attester
is only temporarily unsuitable and the verifier may choose the to indicate
this as a contraindication rather than a full verification failure. See discussion
of the CCA platform lifecycle in <span>[<a href="#RMM" class="cite xref">RMM</a>]</span>.<a href="#section-7-3.3.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-7-4">The Verifier will typically operate a policy where values of some
of the claims in this profile can be compared to reference values, registered
with the Verifier for a given deployment, in order to confirm that the device
is endorsed by the manufacturer supply chain.  The policy may require that the
relevant claims must have a match to a registered reference value.  All claims
may be worthy of additional appraisal.  It is likely that most deployments
would include a policy with appraisal for the following claims:<a href="#section-7-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-5.1">
          <p id="section-7-5.1.1">Implementation ID - the value of the Implementation ID can be used to
identify the verification requirements of the deployment.<a href="#section-7-5.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-7-5.2">
          <p id="section-7-5.2.1">Software Component, Measurement Value - this value can uniquely identify a
firmware release from the supply chain. In some cases, a Verifier may
maintain a record for a series of firmware releases, being patches to an
original baseline release. A verification policy may then allow this value to
match any point on that release sequence or expect some minimum level of
maturity related to the sequence.<a href="#section-7-5.2.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-7-5.3">
          <p id="section-7-5.3.1">Software Component, Signer ID - where present in a deployment, this could
allow a Verifier to operate a more general policy than that for Measurement
Value as above, by allowing a token to contain any firmware entries signed by
a known Signer ID, without checking for a uniquely registered version.<a href="#section-7-5.3.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<div id="ar4si-trustworthiness-claims-mappings">
<section id="section-7.1">
        <h3 id="name-ar4si-trustworthiness-claim">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-ar4si-trustworthiness-claim" class="section-name selfRef">AR4SI Trustworthiness Claims Mappings</a>
        </h3>
<p id="section-7.1-1"><span>[<a href="#RATS-AR4SI" class="cite xref">RATS-AR4SI</a>]</span> defines an information model that Verifiers can employ to
produce Attestation Results.
AR4SI provides a set of standardized appraisal categories and tiers that
greatly simplifies the task of writing Relying Party policies in multi-attester
environments.<a href="#section-7.1-1" class="pilcrow">Â¶</a></p>
<p id="section-7.1-2">The contents of <a href="#tab-ar4si-map" class="auto internal xref">Table 3</a> are intended as guidance for implementing a
PSA Verifier that computes its results using AR4SI.
The table describes which PSA Evidence claims (if any) are related to which
AR4SI trustworthiness claim, and therefore what the Verifier must consider when
deciding if and how to appraise a certain feature associated with the PSA
Attester.<a href="#section-7.1-2" class="pilcrow">Â¶</a></p>
<span id="name-ar4si-claims-mappings"></span><div id="tab-ar4si-map">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-ar4si-claims-mappings" class="selfRef">AR4SI Claims mappings</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Trustworthiness Vector claims</th>
              <th class="text-left" rowspan="1" colspan="1">Related PSA claims</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>configuration</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Software Components (<a href="#sec-sw-components" class="auto internal xref">Section 4.6.1</a>)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>executables</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">ditto</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>file-system</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>hardware</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Implementation ID (<a href="#sec-implementation-id" class="auto internal xref">Section 4.4.2</a>) and CCA Platform config (TODO)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>instance-identity</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Instance ID (<a href="#sec-instance-id-claim" class="auto internal xref">Section 4.4.1</a>).  The Security Lifecycle (<a href="#sec-security-lifecycle" class="auto internal xref">Section 4.5.2</a>) can also impact the derived identity.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>runtime-opaque</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Indirectly derived from <code>executables</code>, <code>hardware</code>, and <code>instance-identity</code>.  The Security Lifecycle (<a href="#sec-security-lifecycle" class="auto internal xref">Section 4.5.2</a>) can also be relevant: for example, any debug state will expose otherwise protected memory.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>sourced-data</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>storage-opaque</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Indirectly derived from <code>executables</code>, <code>hardware</code>, and <code>instance-identity</code>.</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.1-4">This document does not prescribe what value must be chosen based on each
possible situation: when assigning specific Trustworthiness Claim values, an
implementation is expected to follow the algorithm described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-06#section-2.3.3" class="relref">Section 2.3.3</a> of [<a href="#RATS-AR4SI" class="cite xref">RATS-AR4SI</a>]</span>.<a href="#section-7.1-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-cca-endorsements">
<section id="section-7.2">
        <h3 id="name-endorsements-reference-valu">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-endorsements-reference-valu" class="section-name selfRef">Endorsements, Reference Values and Verification Key Material</a>
        </h3>
<p id="section-7.2-1">The <strong>TODO</strong>  ref-to-CCA-Endorsements defines a protocol based on the <span>[<a href="#RATS-CoRIM" class="cite xref">RATS-CoRIM</a>]</span> data model
that can be used to convey CCA Endorsements, Reference Values and verification
key material to the Verifier.
TODO... perhaps redact this section until a cca-endorsements draft is available?<a href="#section-7.2-1" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-status">
<section id="section-8">
      <h2 id="name-implementation-status">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-8-1"><span class="cref" id="rfc-ed-note">RFC Editor:</span> please remove this section before pubblication.<a href="#section-8-1" class="pilcrow">Â¶</a></p>
<p id="section-8-2">Implementations of this specification are provided by the Trusted
Firmware-RMM project <span>[<a href="#TF-RMM" class="cite xref">TF-RMM</a>]</span> and the Veraison project <span>[<a href="#Veraison" class="cite xref">Veraison</a>]</span>.
These implementations are released as open-source software.<a href="#section-8-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-security-consideration">
<section id="section-9">
      <h2 id="name-security-and-privacy-consid">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-and-privacy-consid" class="section-name selfRef">Security and Privacy Considerations</a>
      </h2>
<p id="section-9-1">This specification re-uses the EAT specification and therefore the CWT specification.
Hence, the security and privacy considerations of those specifications apply here as well.<a href="#section-9-1" class="pilcrow">Â¶</a></p>
<p id="section-9-2">TODO... questionable ability to execute on this as anyone can call RSI??
A PSA Attester MUST NOT provide Evidence to an untrusted
challenger, as it may allow attackers to interpose and trick the Verifier into
believing the attacker is a legitimate Attester.
This is especially relevant to protocols that use PSA attestation tokens to authenticate the attester to a relying party.<a href="#section-9-2" class="pilcrow">Â¶</a></p>
<p id="section-9-3">Attestation tokens contain information that may be unique to a device and
therefore they may allow singling out an individual device for tracking
purposes.  Deployments that have privacy requirements must take appropriate
measures to ensure that the token is only used to provision anonymous/pseudonym
keys.<a href="#section-9-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="cbor-web-token-claims-registration">
<section id="section-10.1">
        <h3 id="name-cbor-web-token-claims-regis">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-cbor-web-token-claims-regis" class="section-name selfRef">CBOR Web Token Claims Registration</a>
        </h3>
<p id="section-10.1-1">IANA is requested to make permanent the following claims that have been
assigned via early allocation in the "CBOR Web Token (CWT) Claims" registry
<span>[<a href="#IANA-CWT" class="cite xref">IANA-CWT</a>]</span>.<a href="#section-10.1-1" class="pilcrow">Â¶</a></p>
<div id="security-lifecycle-claim">
<section id="section-10.1.1">
          <h4 id="name-security-lifecycle-claim">
<a href="#section-10.1.1" class="section-number selfRef">10.1.1. </a><a href="#name-security-lifecycle-claim" class="section-name selfRef">Security Lifecycle Claim</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.1-1.1">
              <p id="section-10.1.1-1.1.1">Claim Name: arm-platform-security-lifecycle<a href="#section-10.1.1-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.1-1.2">
              <p id="section-10.1.1-1.2.1">Claim Description: Arm Platform Security Lifecycle<a href="#section-10.1.1-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.1-1.3">
              <p id="section-10.1.1-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.1-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.1-1.4">
              <p id="section-10.1.1-1.4.1">Claim Key: 2395<a href="#section-10.1.1-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.1-1.5">
              <p id="section-10.1.1-1.5.1">Claim Value Type(s): unsigned integer<a href="#section-10.1.1-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.1-1.6">
              <p id="section-10.1.1-1.6.1">Change Controller: Hannes Tschofenig      TODO... find document centric change controller...<a href="#section-10.1.1-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.1-1.7">
              <p id="section-10.1.1-1.7.1">Specification Document(s): <a href="#sec-security-lifecycle" class="auto internal xref">Section 4.5.2</a> of RFCthis<a href="#section-10.1.1-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="implementation-id-claim">
<section id="section-10.1.2">
          <h4 id="name-implementation-id-claim">
<a href="#section-10.1.2" class="section-number selfRef">10.1.2. </a><a href="#name-implementation-id-claim" class="section-name selfRef">Implementation ID Claim</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.2-1.1">
              <p id="section-10.1.2-1.1.1">Claim Name: arm-platform-implementation-id<a href="#section-10.1.2-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.2-1.2">
              <p id="section-10.1.2-1.2.1">Claim Description: Arm Platform Implementation ID<a href="#section-10.1.2-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.2-1.3">
              <p id="section-10.1.2-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.2-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.2-1.4">
              <p id="section-10.1.2-1.4.1">Claim Key: 2396<a href="#section-10.1.2-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.2-1.5">
              <p id="section-10.1.2-1.5.1">Claim Value Type(s): byte string<a href="#section-10.1.2-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.2-1.6">
              <p id="section-10.1.2-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.2-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.2-1.7">
              <p id="section-10.1.2-1.7.1">Specification Document(s): <a href="#sec-implementation-id" class="auto internal xref">Section 4.4.2</a> of RFCthis<a href="#section-10.1.2-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="software-components-claim">
<section id="section-10.1.3">
          <h4 id="name-software-components-claim">
<a href="#section-10.1.3" class="section-number selfRef">10.1.3. </a><a href="#name-software-components-claim" class="section-name selfRef">Software Components Claim</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.3-1.1">
              <p id="section-10.1.3-1.1.1">Claim Name: arm-platform-software-components<a href="#section-10.1.3-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.3-1.2">
              <p id="section-10.1.3-1.2.1">Claim Description: Arm Platform Software Components<a href="#section-10.1.3-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.3-1.3">
              <p id="section-10.1.3-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.3-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.3-1.4">
              <p id="section-10.1.3-1.4.1">Claim Key: 2399<a href="#section-10.1.3-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.3-1.5">
              <p id="section-10.1.3-1.5.1">Claim Value Type(s): array<a href="#section-10.1.3-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.3-1.6">
              <p id="section-10.1.3-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.3-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.3-1.7">
              <p id="section-10.1.3-1.7.1">Specification Document(s): <a href="#sec-sw-components" class="auto internal xref">Section 4.6.1</a> of RFCthis<a href="#section-10.1.3-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="verification-service-indicator-claim">
<section id="section-10.1.4">
          <h4 id="name-verification-service-indicat">
<a href="#section-10.1.4" class="section-number selfRef">10.1.4. </a><a href="#name-verification-service-indicat" class="section-name selfRef">Verification Service Indicator Claim</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.4-1.1">
              <p id="section-10.1.4-1.1.1">Claim Name: arm-platform-verification-service-indicator<a href="#section-10.1.4-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.4-1.2">
              <p id="section-10.1.4-1.2.1">Claim Description: Arm Platform Verification Service Indicator<a href="#section-10.1.4-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.4-1.3">
              <p id="section-10.1.4-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.4-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.4-1.4">
              <p id="section-10.1.4-1.4.1">Claim Key: 2400<a href="#section-10.1.4-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.4-1.5">
              <p id="section-10.1.4-1.5.1">Claim Value Type(s): text string<a href="#section-10.1.4-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.4-1.6">
              <p id="section-10.1.4-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.4-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.4-1.7">
              <p id="section-10.1.4-1.7.1">Specification Document(s): <a href="#sec-verification-service-indicator" class="auto internal xref">Section 4.7.1</a> of RFCthis<a href="#section-10.1.4-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="platform-config-claim">
<section id="section-10.1.5">
          <h4 id="name-platform-config-claim">
<a href="#section-10.1.5" class="section-number selfRef">10.1.5. </a><a href="#name-platform-config-claim" class="section-name selfRef">Platform Config Claim</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.5-1.1">
              <p id="section-10.1.5-1.1.1">Claim Name: arm-platform-config<a href="#section-10.1.5-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.5-1.2">
              <p id="section-10.1.5-1.2.1">Claim Description: Arm Platform Configuration<a href="#section-10.1.5-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.5-1.3">
              <p id="section-10.1.5-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.5-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.5-1.4">
              <p id="section-10.1.5-1.4.1">Claim Key: 2401<a href="#section-10.1.5-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.5-1.5">
              <p id="section-10.1.5-1.5.1">Claim Value Type(s): byte string<a href="#section-10.1.5-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.5-1.6">
              <p id="section-10.1.5-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.5-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.5-1.7">
              <p id="section-10.1.5-1.7.1">Specification Document(s): <a href="#sec-platform-config" class="auto internal xref">Section 4.5.3</a> of RFCthis<a href="#section-10.1.5-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="platform-hash-algorithm-id-clain">
<section id="section-10.1.6">
          <h4 id="name-platform-hash-algorithm-id-">
<a href="#section-10.1.6" class="section-number selfRef">10.1.6. </a><a href="#name-platform-hash-algorithm-id-" class="section-name selfRef">Platform Hash Algorithm ID Clain</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.6-1.1">
              <p id="section-10.1.6-1.1.1">Claim Name: arm-platform-hash-algm-id<a href="#section-10.1.6-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.6-1.2">
              <p id="section-10.1.6-1.2.1">Claim Description: Arm Platform Hash Algorithm ID<a href="#section-10.1.6-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.6-1.3">
              <p id="section-10.1.6-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.6-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.6-1.4">
              <p id="section-10.1.6-1.4.1">Claim Key: 2402<a href="#section-10.1.6-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.6-1.5">
              <p id="section-10.1.6-1.5.1">Claim Value Type(s): text string<a href="#section-10.1.6-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.6-1.6">
              <p id="section-10.1.6-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.6-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.6-1.7">
              <p id="section-10.1.6-1.7.1">Specification Document(s): <a href="#sec-arm-platform-hash-algm-id" class="auto internal xref">Section 4.7.2</a> of RFCthis<a href="#section-10.1.6-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="cca-token-platform-token-label">
<section id="section-10.1.7">
          <h4 id="name-cca-token-platform-token-la">
<a href="#section-10.1.7" class="section-number selfRef">10.1.7. </a><a href="#name-cca-token-platform-token-la" class="section-name selfRef">CCA Token Platform Token Label</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.7-1.1">
              <p id="section-10.1.7-1.1.1">Claim Name: cca-platform-token-label<a href="#section-10.1.7-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.7-1.2">
              <p id="section-10.1.7-1.2.1">Claim Description: CCA Token Platform Token Label<a href="#section-10.1.7-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.7-1.3">
              <p id="section-10.1.7-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.7-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.7-1.4">
              <p id="section-10.1.7-1.4.1">Claim Key: 44234<a href="#section-10.1.7-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.7-1.5">
              <p id="section-10.1.7-1.5.1">Claim Value Type(s): byte string<a href="#section-10.1.7-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.7-1.6">
              <p id="section-10.1.7-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.7-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.7-1.7">
              <p id="section-10.1.7-1.7.1">Specification Document(s): <a href="#sec-cca-token-collection" class="auto internal xref">Section 4.1</a> of RFCthis<a href="#section-10.1.7-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="realm-personalization-value-claim">
<section id="section-10.1.8">
          <h4 id="name-realm-personalization-value">
<a href="#section-10.1.8" class="section-number selfRef">10.1.8. </a><a href="#name-realm-personalization-value" class="section-name selfRef">Realm Personalization Value Claim</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.8-1.1">
              <p id="section-10.1.8-1.1.1">Claim Name: cca-realm-personalization-value<a href="#section-10.1.8-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.8-1.2">
              <p id="section-10.1.8-1.2.1">Claim Description: CCA Realm Personalisation Value<a href="#section-10.1.8-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.8-1.3">
              <p id="section-10.1.8-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.8-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.8-1.4">
              <p id="section-10.1.8-1.4.1">Claim Key: 44235<a href="#section-10.1.8-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.8-1.5">
              <p id="section-10.1.8-1.5.1">Claim Value Type(s): byte string<a href="#section-10.1.8-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.8-1.6">
              <p id="section-10.1.8-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.8-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.8-1.7">
              <p id="section-10.1.8-1.7.1">Specification Document(s): <a href="#sec-realm-personalisation-value-claim" class="auto internal xref">Section 4.8.3</a> of RFCthis<a href="#section-10.1.8-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="realm-hash-algorithm-id-claim">
<section id="section-10.1.9">
          <h4 id="name-realm-hash-algorithm-id-cla">
<a href="#section-10.1.9" class="section-number selfRef">10.1.9. </a><a href="#name-realm-hash-algorithm-id-cla" class="section-name selfRef">Realm Hash Algorithm ID Claim</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.9-1.1">
              <p id="section-10.1.9-1.1.1">Claim Name: cca-realm-hash-algm-id<a href="#section-10.1.9-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.9-1.2">
              <p id="section-10.1.9-1.2.1">Claim Description: CCA Realm Hash Algorithm ID<a href="#section-10.1.9-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.9-1.3">
              <p id="section-10.1.9-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.9-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.9-1.4">
              <p id="section-10.1.9-1.4.1">Claim Key: 44236<a href="#section-10.1.9-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.9-1.5">
              <p id="section-10.1.9-1.5.1">Claim Value Type(s): text string<a href="#section-10.1.9-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.9-1.6">
              <p id="section-10.1.9-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.9-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.9-1.7">
              <p id="section-10.1.9-1.7.1">Specification Document(s): <a href="#sec-realm-hash-algm-id-claim" class="auto internal xref">Section 4.8.6</a> of RFCthis<a href="#section-10.1.9-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="realm-public-key-claim">
<section id="section-10.1.10">
          <h4 id="name-realm-public-key-claim">
<a href="#section-10.1.10" class="section-number selfRef">10.1.10. </a><a href="#name-realm-public-key-claim" class="section-name selfRef">Realm Public Key Claim</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.10-1.1">
              <p id="section-10.1.10-1.1.1">Claim Name: cca-realm-public-key<a href="#section-10.1.10-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.10-1.2">
              <p id="section-10.1.10-1.2.1">Claim Description: CCA Realm Public Key<a href="#section-10.1.10-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.10-1.3">
              <p id="section-10.1.10-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.10-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.10-1.4">
              <p id="section-10.1.10-1.4.1">Claim Key: 44237<a href="#section-10.1.10-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.10-1.5">
              <p id="section-10.1.10-1.5.1">Claim Value Type(s): byte string<a href="#section-10.1.10-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.10-1.6">
              <p id="section-10.1.10-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.10-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.10-1.7">
              <p id="section-10.1.10-1.7.1">Specification Document(s): <a href="#sec-realm-public-key-claim" class="auto internal xref">Section 4.8.7</a> of RFCthis<a href="#section-10.1.10-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="realm-initial-measurement-claim">
<section id="section-10.1.11">
          <h4 id="name-realm-initial-measurement-c">
<a href="#section-10.1.11" class="section-number selfRef">10.1.11. </a><a href="#name-realm-initial-measurement-c" class="section-name selfRef">Realm Initial Measurement Claim</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.11-1.1">
              <p id="section-10.1.11-1.1.1">Claim Name: cca-realm-initial-measurement<a href="#section-10.1.11-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.11-1.2">
              <p id="section-10.1.11-1.2.1">Claim Description: CCA Realm Initial Measurement<a href="#section-10.1.11-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.11-1.3">
              <p id="section-10.1.11-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.11-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.11-1.4">
              <p id="section-10.1.11-1.4.1">Claim Key: 44238<a href="#section-10.1.11-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.11-1.5">
              <p id="section-10.1.11-1.5.1">Claim Value Type(s): byte string<a href="#section-10.1.11-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.11-1.6">
              <p id="section-10.1.11-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.11-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.11-1.7">
              <p id="section-10.1.11-1.7.1">Specification Document(s): <a href="#sec-realm-initial-measurement-claim" class="auto internal xref">Section 4.8.4</a> of RFCthis<a href="#section-10.1.11-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="realm-extensible-measurements-claim">
<section id="section-10.1.12">
          <h4 id="name-realm-extensible-measurement">
<a href="#section-10.1.12" class="section-number selfRef">10.1.12. </a><a href="#name-realm-extensible-measurement" class="section-name selfRef">Realm Extensible Measurements Claim</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.12-1.1">
              <p id="section-10.1.12-1.1.1">Claim Name: cca-realm-extensible-measurements<a href="#section-10.1.12-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.12-1.2">
              <p id="section-10.1.12-1.2.1">Claim Description: CCA Realm Extensible Measurements<a href="#section-10.1.12-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.12-1.3">
              <p id="section-10.1.12-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.12-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.12-1.4">
              <p id="section-10.1.12-1.4.1">Claim Key: 44239<a href="#section-10.1.12-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.12-1.5">
              <p id="section-10.1.12-1.5.1">Claim Value Type(s): array<a href="#section-10.1.12-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.12-1.6">
              <p id="section-10.1.12-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.12-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.12-1.7">
              <p id="section-10.1.12-1.7.1">Specification Document(s): <a href="#sec-realm-initial-measurement-claim" class="auto internal xref">Section 4.8.4</a> of RFCthis<a href="#section-10.1.12-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="realm-public-key-hash-algorithm-id-claim">
<section id="section-10.1.13">
          <h4 id="name-realm-public-key-hash-algori">
<a href="#section-10.1.13" class="section-number selfRef">10.1.13. </a><a href="#name-realm-public-key-hash-algori" class="section-name selfRef">Realm Public Key Hash Algorithm ID Claim</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.13-1.1">
              <p id="section-10.1.13-1.1.1">Claim Name: cca-realm-public-key-hash-algm-id<a href="#section-10.1.13-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.13-1.2">
              <p id="section-10.1.13-1.2.1">Claim Description: Realm Public Key Hash Algorithm ID Claim<a href="#section-10.1.13-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.13-1.3">
              <p id="section-10.1.13-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.13-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.13-1.4">
              <p id="section-10.1.13-1.4.1">Claim Key: 44240<a href="#section-10.1.13-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.13-1.5">
              <p id="section-10.1.13-1.5.1">Claim Value Type(s): text string<a href="#section-10.1.13-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.13-1.6">
              <p id="section-10.1.13-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.13-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.13-1.7">
              <p id="section-10.1.13-1.7.1">Specification Document(s): <a href="#sec-realm-public-key-hash-algo-id-claim" class="auto internal xref">Section 4.8.8</a> of RFCthis<a href="#section-10.1.13-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="cca-token-delegated-realm-token-label">
<section id="section-10.1.14">
          <h4 id="name-cca-token-delegated-realm-t">
<a href="#section-10.1.14" class="section-number selfRef">10.1.14. </a><a href="#name-cca-token-delegated-realm-t" class="section-name selfRef">CCA Token Delegated Realm Token Label</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.1.14-1.1">
              <p id="section-10.1.14-1.1.1">Claim Name: cca-platform-delegated-realm-label<a href="#section-10.1.14-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.14-1.2">
              <p id="section-10.1.14-1.2.1">Claim Description: CCA Token Platform Token Label<a href="#section-10.1.14-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.14-1.3">
              <p id="section-10.1.14-1.3.1">JWT Claim Name: N/A<a href="#section-10.1.14-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.14-1.4">
              <p id="section-10.1.14-1.4.1">Claim Key: 44241<a href="#section-10.1.14-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.14-1.5">
              <p id="section-10.1.14-1.5.1">Claim Value Type(s): byte string<a href="#section-10.1.14-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.14-1.6">
              <p id="section-10.1.14-1.6.1">Change Controller: Hannes Tschofenig<a href="#section-10.1.14-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.1.14-1.7">
              <p id="section-10.1.14-1.7.1">Specification Document(s): <a href="#sec-cca-token-collection" class="auto internal xref">Section 4.1</a> of RFCthis<a href="#section-10.1.14-1.7.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="sec-iana-media-types">
<section id="section-10.2">
        <h3 id="name-media-types">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-media-types" class="section-name selfRef">Media Types</a>
        </h3>
<p id="section-10.2-1">No new media type registration is requested.
To indicate that the transmitted content is a CCA attestation token,
applications can use the <code>application/eat+cwt</code> media type defined in
<span>[<a href="#EAT-MEDIATYPES" class="cite xref">EAT-MEDIATYPES</a>]</span> with the <code>eat_profile</code> parameter set to
<code>tag:arm.com,2023:cca#1.0.0</code>.<a href="#section-10.2-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-iana-coap-content-format">
<section id="section-10.3">
        <h3 id="name-coap-content-formats-regist">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-coap-content-formats-regist" class="section-name selfRef">CoAP Content-Formats Registration</a>
        </h3>
<p id="section-10.3-1">IANA is requested to register a CoAP Content-Format ID in the "CoAP
Content-Formats" registry <span>[<a href="#IANA-CoAP-Content-Formats" class="cite xref">IANA-CoAP-Content-Formats</a>]</span>:<a href="#section-10.3-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-2.1">
            <p id="section-10.3-2.1.1">A registration for the <code>application/eat+cwt</code> media type with the <code>eat_profile</code> parameter
equal to "tag:arm.com,2023:cca#1.0.0"<a href="#section-10.3-2.1.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-10.3-3">The Content-Formats should be allocated from the Expert review range (0-255).<a href="#section-10.3-3" class="pilcrow">Â¶</a></p>
<div id="registry-contents">
<section id="section-10.3.1">
          <h4 id="name-registry-contents">
<a href="#section-10.3.1" class="section-number selfRef">10.3.1. </a><a href="#name-registry-contents" class="section-name selfRef">Registry Contents</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-10.3.1-1.1">
              <p id="section-10.3.1-1.1.1">Media Type: `application/eat+cwt; eat_profile="tag:arm.com,2023:cca#1.0.0"<a href="#section-10.3.1-1.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.3.1-1.2">
              <p id="section-10.3.1-1.2.1">Encoding: -<a href="#section-10.3.1-1.2.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.3.1-1.3">
              <p id="section-10.3.1-1.3.1">Id: To-be-assigned by IANA<a href="#section-10.3.1-1.3.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.3.1-1.4">
              <p id="section-10.3.1-1.4.1">Reference: RFCthis<a href="#section-10.3.1-1.4.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.3.1-1.5">
              <p id="section-10.3.1-1.5.1">Media Type: `application/eat+cwt; eat_profile="tag:arm.com,2023:realm#1.0.0"<a href="#section-10.3.1-1.5.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.3.1-1.6">
              <p id="section-10.3.1-1.6.1">Encoding: -<a href="#section-10.3.1-1.6.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.3.1-1.7">
              <p id="section-10.3.1-1.7.1">Id: To-be-assigned by IANA<a href="#section-10.3.1-1.7.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-10.3.1-1.8">
              <p id="section-10.3.1-1.8.1">Reference: RFCthis<a href="#section-10.3.1-1.8.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="CCA-ARCH">[CCA-ARCH]</dt>
        <dd>
<span class="refAuthor">Arm</span>, <span class="refTitle">"Learn the architecture - Introducing Arm Confidential Compute Architecture"</span>, <time datetime="2023-05" class="refDate">May 2023</time>, <span>&lt;<a href="https://developer.arm.com/documentation/den0125/0300">https://developer.arm.com/documentation/den0125/0300</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CMW">[CMW]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Smith, N.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"RATS Conceptual Messages Wrapper (CMW)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-msg-wrap-06</span>, <time datetime="2024-07-01" class="refDate">1 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-06">https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE-ALGS">[COSE-ALGS]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9053">https://www.rfc-editor.org/rfc/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EAT">[EAT]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-eat-28</span>, <time datetime="2024-06-25" class="refDate">25 June 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-28">https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-28</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EAT-MEDIATYPES">[EAT-MEDIATYPES]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Birkholz, H.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"EAT Media Types"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-eat-media-type-07</span>, <time datetime="2024-04-02" class="refDate">2 April 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-media-type-07">https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-media-type-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-CWT">[IANA-CWT]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"CBOR Web Token (CWT) Claims"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://www.iana.org/assignments/cwt/cwt.xhtml#claims-registry">https://www.iana.org/assignments/cwt/cwt.xhtml#claims-registry</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.named-information">[IANA.named-information]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Named Information"</span>, <span>&lt;<a href="http://www.iana.org/assignments/named-information">http://www.iana.org/assignments/named-information</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RME">[RME]</dt>
        <dd>
<span class="refAuthor">Arm</span>, <span class="refTitle">"Learn the architecture - Realm Management Extension"</span>, <time datetime="2021-06" class="refDate">June 2021</time>, <span>&lt;<a href="https://developer.arm.com/documentation/den0126/0100">https://developer.arm.com/documentation/den0126/0100</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RMM">[RMM]</dt>
        <dd>
<span class="refAuthor">Arm</span>, <span class="refTitle">"Realm Management Monitor specification 1.0"</span>, <time datetime="2022-12" class="refDate">December 2022</time>, <span>&lt;<a href="https://developer.arm.com/documentation/den0137/1-0bet2">https://developer.arm.com/documentation/den0137/1-0bet2</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD94">[STD94]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD96">[STD96]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X509">[X509]</dt>
      <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="COSE-X509">[COSE-X509]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Header Parameters for Carrying and Referencing X.509 Certificates"</span>, <span class="seriesInfo">RFC 9360</span>, <span class="seriesInfo">DOI 10.17487/RFC9360</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9360">https://www.rfc-editor.org/rfc/rfc9360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.kdyxy-rats-tdx-eat-profile">[I-D.kdyxy-rats-tdx-eat-profile]</dt>
        <dd>
<span class="refAuthor">Kostal, G.</span>, <span class="refAuthor">Dittakavi, S.</span>, <span class="refAuthor">Yeluri, R.</span>, <span class="refAuthor">Xia, H.</span>, and <span class="refAuthor">J. Yu</span>, <span class="refTitle">"EAT profile for IntelÂ® Trust Domain Extensions (TDX) attestation result"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-kdyxy-rats-tdx-eat-profile-01</span>, <time datetime="2024-04-23" class="refDate">23 April 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-kdyxy-rats-tdx-eat-profile-01">https://datatracker.ietf.org/doc/html/draft-kdyxy-rats-tdx-eat-profile-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mandyam-rats-qwestoken">[I-D.mandyam-rats-qwestoken]</dt>
        <dd>
<span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">Sekhar, V.</span>, and <span class="refAuthor">S. Mohammed</span>, <span class="refTitle">"The Qualcomm Wireless Edge Services (QWES) Attestation Token"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mandyam-rats-qwestoken-00</span>, <time datetime="2019-11-01" class="refDate">1 November 2019</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-mandyam-rats-qwestoken-00">https://datatracker.ietf.org/doc/html/draft-mandyam-rats-qwestoken-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-CoAP-Content-Formats">[IANA-CoAP-Content-Formats]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"CoAP Content-Formats"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://www.iana.org/assignments/core-parameters">https://www.iana.org/assignments/core-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RATS-AR4SI">[RATS-AR4SI]</dt>
        <dd>
<span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Hardjono, T.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">V. Scarlata</span>, <span class="refTitle">"Attestation Results for Secure Interactions"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-ar4si-06</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-06">https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RATS-CoRIM">[RATS-CoRIM]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Deshpande, Y.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Concise Reference Integrity Manifest"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-corim-04</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-04">https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9334">https://www.rfc-editor.org/rfc/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TF-RMM">[TF-RMM]</dt>
        <dd>
<span class="refAuthor">Trusted Firmware Project</span>, <span class="refTitle">"Trusted Firmware-RMM"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://www.trustedfirmware.org/projects/tf-rmm">https://www.trustedfirmware.org/projects/tf-rmm</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS12-IoT">[TLS12-IoT]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H., Ed.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things"</span>, <span class="seriesInfo">RFC 7925</span>, <span class="seriesInfo">DOI 10.17487/RFC7925</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7925">https://www.rfc-editor.org/rfc/rfc7925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS13-IoT">[TLS13-IoT]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"TLS/DTLS 1.3 Profiles for the Internet of Things"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-uta-tls13-iot-profile-09</span>, <time datetime="2024-03-03" class="refDate">3 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-uta-tls13-iot-profile-09">https://datatracker.ietf.org/doc/html/draft-ietf-uta-tls13-iot-profile-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Veraison">[Veraison]</dt>
      <dd>
<span class="refAuthor">The Veraison Project</span>, <span class="refTitle">"Veraison ccatoken package"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://github.com/veraison/ccatoken">https://github.com/veraison/ccatoken</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-A-1">The following examples show CCA attestation tokens for an hypothetical system
comprising a single measured software component.
The attesting device is in a lifecycle state (<a href="#sec-security-lifecycle" class="auto internal xref">Section 4.5.2</a>) of
SECURED.<a href="#appendix-A-1" class="pilcrow">Â¶</a></p>
<div id="ex-sign1">
<section id="appendix-A.1">
        <h3 id="name-cose-sign1-token">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-cose-sign1-token" class="section-name selfRef">COSE Sign1 Token</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-A.1-1">
<pre>
TODO...include cddl/example/sign1-claims.diag
</pre><a href="#appendix-A.1-1" class="pilcrow">Â¶</a>
</div>
<p id="appendix-A.1-2">The JWK representation of the PAK used for creating the COSE Sign1 signature
over the PSA token is:<a href="#appendix-A.1-2" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-3">
<pre>
TODO...include cddl/example/tfm-es-iak.json
</pre><a href="#appendix-A.1-3" class="pilcrow">Â¶</a>
</div>
<p id="appendix-A.1-4">The resulting COSE object is:<a href="#appendix-A.1-4" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-5">
<pre>
TODO...include cddl/example/psa-sign1.diag
</pre><a href="#appendix-A.1-5" class="pilcrow">Â¶</a>
</div>
<p id="appendix-A.1-6">which has the following base16 encoding:<a href="#appendix-A.1-6" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-7">
<pre>
TODO...include cddl/example/psa-sign1.hex
</pre><a href="#appendix-A.1-7" class="pilcrow">Â¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">TODO<a href="#appendix-B-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-C">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yogesh Deshpande</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Yogesh.Deshpande@arm.com" class="email">Yogesh.Deshpande@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sergei Trofimov</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Sergei.Trofimov@arm.com" class="email">Sergei.Trofimov@arm.com</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Simon Frost</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Simon.Frost@arm.com" class="email">Simon.Frost@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thomas Fossati</span></div>
<div dir="auto" class="left"><span class="org">Linaro</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:thomas.fossati@linaro.org" class="email">thomas.fossati@linaro.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Giri Mandyam</span></div>
<div dir="auto" class="left"><span class="org">Mediatek Inc</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:giridhar.mandyam@gmail.com" class="email">giridhar.mandyam@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
